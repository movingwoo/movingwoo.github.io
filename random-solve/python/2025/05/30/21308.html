<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>21308번 Ternary Machine - 뭐라도 하겠지</title>
<meta name="description" content="문제        21308번 Ternary Machine - 백준     번역      롱——문제  3진수 프로그램을 해석하고 실행하는 인터프리터를 구현해야한다.  명령어는 고정된 형식이 존재하며 표를 참조한다. 올바르지 않은 입력에 대해서는 런타임에러를 출력하는데, 실행되지 않는 오류는 무시한다.  프로그램은 최대 8192자이며 입력이 필요한 경우 충분한 입력이 반드시 주어진다.     설계      구현문제로 보이는데 생각할 부분이 다소 많아보인다. 명령어 해석을 빠르게 처리해야하고 스택과 힙을 구현해야하겠고 예외처리도 해야하고…  주어진 것부터 묵묵히 하다보면 풀리겠지??     구현      1. 입출력과 기본함수  입력은 한번에 받아서 버퍼로 저장해둔다. 필요하면 버퍼에 하나씩 꺼내 쓰도록 하고 출력은 모아뒀다가 한번에 한다.  오류 출력시에는 기존 프로그램이 생성한 출력은 먼저 출력해야하는 것에 주의  isError = False # 입력 버퍼 탐색 인덱스 buffer_index = 0 # 프로그램 탐색 인덱스 program_index = 0 # 명령어 사전 opcodes = [     # 4자리 명령부터 판단     # CODE | PARAM | DESCRIPTION     (&quot;1000&quot;, None, &quot;ADD&quot;),     (&quot;1001&quot;, None, &quot;SUB&quot;),     (&quot;1002&quot;, None, &quot;MUL&quot;),     (&quot;1010&quot;, None, &quot;DIV&quot;),     (&quot;1011&quot;, None, &quot;MOD&quot;),     (&quot;1200&quot;, None, &quot;PRINT_CHAR&quot;),     (&quot;1201&quot;, None, &quot;PRINT_NUM&quot;),     (&quot;1210&quot;, None, &quot;READ_CHAR&quot;),     (&quot;1211&quot;, None, &quot;READ_NUM&quot;),     (&quot;000&quot;, &quot;number&quot;, &quot;PUSH_POS&quot;),     (&quot;001&quot;, &quot;number&quot;, &quot;PUSH_NEG&quot;),     (&quot;020&quot;, None, &quot;DUP&quot;),     (&quot;021&quot;, None, &quot;SWAP&quot;),     (&quot;022&quot;, None, &quot;DROP&quot;),     (&quot;110&quot;, None, &quot;STORE&quot;),     (&quot;111&quot;, None, &quot;LOAD&quot;),     (&quot;200&quot;, &quot;label&quot;, &quot;LABEL&quot;),     (&quot;201&quot;, &quot;label&quot;, &quot;CALL&quot;),     (&quot;202&quot;, &quot;label&quot;, &quot;JUMP&quot;),     (&quot;210&quot;, &quot;label&quot;, &quot;JUMP_IF_ZERO&quot;),     (&quot;211&quot;, &quot;label&quot;, &quot;JUMP_IF_NEG&quot;),     (&quot;212&quot;, None, &quot;RETURN&quot;),     (&quot;222&quot;, None, &quot;HALT&quot;), ] stack = [] heap = {} # 복귀 주소 스택 call_stack = [] # CALL, JUMP 등을 처리하기 위해 label 위치를 미리 매핑해야함 labels = {} # 출력은 리스트에 모아두었다가 한 번에 출력 output = []  print(&#39;&#39;.join(output), end=&#39;&#39;)  if isError:     print(&quot;RUN-TIME ERROR&quot;, end=&#39;&#39;)   한자리 숫자, 문자를 읽는 함수, 라벨을 읽는 함수, 프로그램 내 숫자를 읽는 함수가 필요하다. 스택에 넣는 부분이 많아서 그부분도 따로 함수로 뺀다.  # 버퍼에서 숫자 하나 읽어오는 함수 def read_number():     global buffer_index, isError      # 입력에 공백이 주어지나??     while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isspace():         buffer_index += 1      if buffer_index &gt;= len(input_buffer):         isError = True         return 0          start = buffer_index     # 입력 값이 음수일 수 있음     if input_buffer[buffer_index] == &#39;-&#39;:         buffer_index += 1      while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isdigit():         buffer_index += 1      if start == buffer_index or (input_buffer[start] == &#39;-&#39; and buffer_index == start + 1):         isError = True         return 0      return int(&#39;&#39;.join(input_buffer[start:buffer_index]))  # 버퍼에서 문자 하나 읽어오는 함수 def read_char():     global buffer_index, isError      if buffer_index &gt;= len(input_buffer):         isError = True         return 0          ch = input_buffer[buffer_index]     buffer_index += 1     return ord(ch)  # 프로그램에서 2로 끝나는 레이블을 읽어오는 함수 def read_label():     global program_index, isError     start = program_index      while program_index &lt; len(program):         trit = program[program_index]          if trit == &#39;2&#39;:             label = program[start:program_index]             program_index += 1             return label                  elif trit not in &#39;01&#39;:             isError = True             return None                  program_index += 1          isError = True     return None  # 프로그램 내의 숫자 파싱하는 함수 def parse_number_program():     global program_index, isError     bits = []     count = 0      while program_index &lt; len(program):         trit = program[program_index]         if trit == &#39;0&#39; or trit == &#39;1&#39;:             bits.append(trit)             program_index += 1             count += 1              if count &gt; 31:                 isError = True                 return 0                      elif trit == &#39;2&#39;:             program_index += 1              if not bits:                 isError = True                 return 0                          return int(&#39;&#39;.join(bits), 2)         else:             isError = True             return 0      isError = True     return 0  # 스택에 넣는 함수 def push_stack(value):     global stack, isError      if len(stack) &gt;= 1024:         isError = True         return     stack.append(value)  # 콜스택에 넣는 함수 def push_call_stack(value):     global call_stack, isError      # 서브루틴도 1024 체크 필요     if len(call_stack) &gt;= 1024:         isError = True         return     call_stack.append(value)   2. 레이블 스캔 함수  CALL이나 JUMP 명령 시 어디로 가야하는가? 그것을 미리 알기위해 레이블 스캔을 미리 진행한다. 실행 시 찾으려면 비효율적일 것 같아서리  섣불리 에러처리 해버리면 에러 전까지의 프로그램 아웃풋이 없으므로 주의해야한다.  # label 스캔하는 함수 def scan_labels():     global labels, isError     scan_index = 0       while scan_index &lt; len(program):          # 트릿이 아니면 스캔 종료         if program[scan_index] not in &#39;012&#39;:             break                      matched = False          for code, param, description in opcodes:             if program.startswith(code, scan_index):                 scan_index += len(code)                 matched = True                  # HALT 이후까지 스캔하면 불필요한 오류 발생 가능                 if description == &quot;HALT&quot;:                     # return 해버리니 뒤쪽 레이블이 등록안됨...                     break                                  elif description == &quot;LABEL&quot;:                     # label 읽기                     start = scan_index                      while scan_index &lt; len(program):                         trit = program[scan_index]                          if trit == &#39;2&#39;:                             label = program[start:scan_index]                             scan_index += 1                              if not label or any(c not in &#39;01&#39; for c in label):                                 isError = True                                 return                                                          if label in labels:                                 # 같은 위치에 중복된 레이블이면 허용                                 if labels[label] != scan_index:                                     isError = True                                     return                             else:                                 # label 다음 위치                                 labels[label] = scan_index                             break                          elif trit not in &#39;01&#39;:                             isError = True                             return                         scan_index += 1                     else:                         # 끝까지 2를 못 만남                         isError = True                         return                  # 숫자 건너뛰기                 elif param == &quot;number&quot;:                     count = 0                      while scan_index &lt; len(program):                         trit = program[scan_index]                         scan_index += 1                          if trit == &#39;2&#39;:                             break                         elif trit not in &#39;01&#39;:                             isError = True                             return                         count += 1                          if count &gt; 31:                             isError = True                             return                  # 레이블 건너뛰기                 elif param == &quot;label&quot;:                                          while scan_index &lt; len(program):                         trit = program[scan_index]                         scan_index += 1                          if trit == &#39;2&#39;:                             break                         elif trit not in &#39;01&#39;:                             isError = True                             return                  # param 없는 경우                 break          if not matched:             isError = True             break      return   3. 메인 루프  명령어 조건에 맞춰 메인 루프 작성 가장 단순하고 가장 별거없고 가장 노가다 구간  # 본 로직 while program_index &lt; len(program) and not isError and not halted:      matched = False          for code, param, description in opcodes:          if program.startswith(code, program_index):             program_index += len(code)             matched = True              # 분기 시작              # ... 중략 ...      if not matched:         # 남은 코드가 공백이거나 무의미하면 무시하고 종료         if program_index &gt;= len(program):             break         else:             isError = True             break      채점           반성      하필 또 파이썬이라 푸는데 엄청 오래 걸린 문제  구현만 잘하면 문제없을 줄 알았는데 생각보다 오류가 엄청났다. 레이블 스캔하는 부분에서 뜻대로 잘 동작하지 않아서 결과가 자꾸 틀어짐…  PyPy는 JIT 컴파일러가 있어서 더 빠르다고해서 Python3와 PyPy3 두개로 제출했다. 생각보다 시간 차이가 안나는데, 메모리는 당연히 PyPy3가 많이 쓸거고 속도는 연산자체가 그리 많은 문제가 아니라 큰 차이 안나는 것으로 보인다.  제한시간 빡빡한 문제에서 다시 한 번 비교해봐야할 듯     코드 확인      Link to GitHub">



<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="뭐라도 하겠지">
<meta property="og:title" content="21308번 Ternary Machine">
<meta property="og:url" content="https://movingwoo.com/random-solve/python/2025/05/30/21308.html">


  <meta property="og:description" content="문제        21308번 Ternary Machine - 백준     번역      롱——문제  3진수 프로그램을 해석하고 실행하는 인터프리터를 구현해야한다.  명령어는 고정된 형식이 존재하며 표를 참조한다. 올바르지 않은 입력에 대해서는 런타임에러를 출력하는데, 실행되지 않는 오류는 무시한다.  프로그램은 최대 8192자이며 입력이 필요한 경우 충분한 입력이 반드시 주어진다.     설계      구현문제로 보이는데 생각할 부분이 다소 많아보인다. 명령어 해석을 빠르게 처리해야하고 스택과 힙을 구현해야하겠고 예외처리도 해야하고…  주어진 것부터 묵묵히 하다보면 풀리겠지??     구현      1. 입출력과 기본함수  입력은 한번에 받아서 버퍼로 저장해둔다. 필요하면 버퍼에 하나씩 꺼내 쓰도록 하고 출력은 모아뒀다가 한번에 한다.  오류 출력시에는 기존 프로그램이 생성한 출력은 먼저 출력해야하는 것에 주의  isError = False # 입력 버퍼 탐색 인덱스 buffer_index = 0 # 프로그램 탐색 인덱스 program_index = 0 # 명령어 사전 opcodes = [     # 4자리 명령부터 판단     # CODE | PARAM | DESCRIPTION     (&quot;1000&quot;, None, &quot;ADD&quot;),     (&quot;1001&quot;, None, &quot;SUB&quot;),     (&quot;1002&quot;, None, &quot;MUL&quot;),     (&quot;1010&quot;, None, &quot;DIV&quot;),     (&quot;1011&quot;, None, &quot;MOD&quot;),     (&quot;1200&quot;, None, &quot;PRINT_CHAR&quot;),     (&quot;1201&quot;, None, &quot;PRINT_NUM&quot;),     (&quot;1210&quot;, None, &quot;READ_CHAR&quot;),     (&quot;1211&quot;, None, &quot;READ_NUM&quot;),     (&quot;000&quot;, &quot;number&quot;, &quot;PUSH_POS&quot;),     (&quot;001&quot;, &quot;number&quot;, &quot;PUSH_NEG&quot;),     (&quot;020&quot;, None, &quot;DUP&quot;),     (&quot;021&quot;, None, &quot;SWAP&quot;),     (&quot;022&quot;, None, &quot;DROP&quot;),     (&quot;110&quot;, None, &quot;STORE&quot;),     (&quot;111&quot;, None, &quot;LOAD&quot;),     (&quot;200&quot;, &quot;label&quot;, &quot;LABEL&quot;),     (&quot;201&quot;, &quot;label&quot;, &quot;CALL&quot;),     (&quot;202&quot;, &quot;label&quot;, &quot;JUMP&quot;),     (&quot;210&quot;, &quot;label&quot;, &quot;JUMP_IF_ZERO&quot;),     (&quot;211&quot;, &quot;label&quot;, &quot;JUMP_IF_NEG&quot;),     (&quot;212&quot;, None, &quot;RETURN&quot;),     (&quot;222&quot;, None, &quot;HALT&quot;), ] stack = [] heap = {} # 복귀 주소 스택 call_stack = [] # CALL, JUMP 등을 처리하기 위해 label 위치를 미리 매핑해야함 labels = {} # 출력은 리스트에 모아두었다가 한 번에 출력 output = []  print(&#39;&#39;.join(output), end=&#39;&#39;)  if isError:     print(&quot;RUN-TIME ERROR&quot;, end=&#39;&#39;)   한자리 숫자, 문자를 읽는 함수, 라벨을 읽는 함수, 프로그램 내 숫자를 읽는 함수가 필요하다. 스택에 넣는 부분이 많아서 그부분도 따로 함수로 뺀다.  # 버퍼에서 숫자 하나 읽어오는 함수 def read_number():     global buffer_index, isError      # 입력에 공백이 주어지나??     while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isspace():         buffer_index += 1      if buffer_index &gt;= len(input_buffer):         isError = True         return 0          start = buffer_index     # 입력 값이 음수일 수 있음     if input_buffer[buffer_index] == &#39;-&#39;:         buffer_index += 1      while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isdigit():         buffer_index += 1      if start == buffer_index or (input_buffer[start] == &#39;-&#39; and buffer_index == start + 1):         isError = True         return 0      return int(&#39;&#39;.join(input_buffer[start:buffer_index]))  # 버퍼에서 문자 하나 읽어오는 함수 def read_char():     global buffer_index, isError      if buffer_index &gt;= len(input_buffer):         isError = True         return 0          ch = input_buffer[buffer_index]     buffer_index += 1     return ord(ch)  # 프로그램에서 2로 끝나는 레이블을 읽어오는 함수 def read_label():     global program_index, isError     start = program_index      while program_index &lt; len(program):         trit = program[program_index]          if trit == &#39;2&#39;:             label = program[start:program_index]             program_index += 1             return label                  elif trit not in &#39;01&#39;:             isError = True             return None                  program_index += 1          isError = True     return None  # 프로그램 내의 숫자 파싱하는 함수 def parse_number_program():     global program_index, isError     bits = []     count = 0      while program_index &lt; len(program):         trit = program[program_index]         if trit == &#39;0&#39; or trit == &#39;1&#39;:             bits.append(trit)             program_index += 1             count += 1              if count &gt; 31:                 isError = True                 return 0                      elif trit == &#39;2&#39;:             program_index += 1              if not bits:                 isError = True                 return 0                          return int(&#39;&#39;.join(bits), 2)         else:             isError = True             return 0      isError = True     return 0  # 스택에 넣는 함수 def push_stack(value):     global stack, isError      if len(stack) &gt;= 1024:         isError = True         return     stack.append(value)  # 콜스택에 넣는 함수 def push_call_stack(value):     global call_stack, isError      # 서브루틴도 1024 체크 필요     if len(call_stack) &gt;= 1024:         isError = True         return     call_stack.append(value)   2. 레이블 스캔 함수  CALL이나 JUMP 명령 시 어디로 가야하는가? 그것을 미리 알기위해 레이블 스캔을 미리 진행한다. 실행 시 찾으려면 비효율적일 것 같아서리  섣불리 에러처리 해버리면 에러 전까지의 프로그램 아웃풋이 없으므로 주의해야한다.  # label 스캔하는 함수 def scan_labels():     global labels, isError     scan_index = 0       while scan_index &lt; len(program):          # 트릿이 아니면 스캔 종료         if program[scan_index] not in &#39;012&#39;:             break                      matched = False          for code, param, description in opcodes:             if program.startswith(code, scan_index):                 scan_index += len(code)                 matched = True                  # HALT 이후까지 스캔하면 불필요한 오류 발생 가능                 if description == &quot;HALT&quot;:                     # return 해버리니 뒤쪽 레이블이 등록안됨...                     break                                  elif description == &quot;LABEL&quot;:                     # label 읽기                     start = scan_index                      while scan_index &lt; len(program):                         trit = program[scan_index]                          if trit == &#39;2&#39;:                             label = program[start:scan_index]                             scan_index += 1                              if not label or any(c not in &#39;01&#39; for c in label):                                 isError = True                                 return                                                          if label in labels:                                 # 같은 위치에 중복된 레이블이면 허용                                 if labels[label] != scan_index:                                     isError = True                                     return                             else:                                 # label 다음 위치                                 labels[label] = scan_index                             break                          elif trit not in &#39;01&#39;:                             isError = True                             return                         scan_index += 1                     else:                         # 끝까지 2를 못 만남                         isError = True                         return                  # 숫자 건너뛰기                 elif param == &quot;number&quot;:                     count = 0                      while scan_index &lt; len(program):                         trit = program[scan_index]                         scan_index += 1                          if trit == &#39;2&#39;:                             break                         elif trit not in &#39;01&#39;:                             isError = True                             return                         count += 1                          if count &gt; 31:                             isError = True                             return                  # 레이블 건너뛰기                 elif param == &quot;label&quot;:                                          while scan_index &lt; len(program):                         trit = program[scan_index]                         scan_index += 1                          if trit == &#39;2&#39;:                             break                         elif trit not in &#39;01&#39;:                             isError = True                             return                  # param 없는 경우                 break          if not matched:             isError = True             break      return   3. 메인 루프  명령어 조건에 맞춰 메인 루프 작성 가장 단순하고 가장 별거없고 가장 노가다 구간  # 본 로직 while program_index &lt; len(program) and not isError and not halted:      matched = False          for code, param, description in opcodes:          if program.startswith(code, program_index):             program_index += len(code)             matched = True              # 분기 시작              # ... 중략 ...      if not matched:         # 남은 코드가 공백이거나 무의미하면 무시하고 종료         if program_index &gt;= len(program):             break         else:             isError = True             break      채점           반성      하필 또 파이썬이라 푸는데 엄청 오래 걸린 문제  구현만 잘하면 문제없을 줄 알았는데 생각보다 오류가 엄청났다. 레이블 스캔하는 부분에서 뜻대로 잘 동작하지 않아서 결과가 자꾸 틀어짐…  PyPy는 JIT 컴파일러가 있어서 더 빠르다고해서 Python3와 PyPy3 두개로 제출했다. 생각보다 시간 차이가 안나는데, 메모리는 당연히 PyPy3가 많이 쓸거고 속도는 연산자체가 그리 많은 문제가 아니라 큰 차이 안나는 것으로 보인다.  제한시간 빡빡한 문제에서 다시 한 번 비교해봐야할 듯     코드 확인      Link to GitHub">







  <meta property="article:published_time" content="2025-05-30T01:00:00+00:00">



  <meta property="article:modified_time" content="2025-05-30T01:00:00+00:00">




<link rel="canonical" href="https://movingwoo.com/random-solve/python/2025/05/30/21308.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "뭐라도 하겠지",
      "url": "https://movingwoo.com/"
    
  }
</script>







<!-- end _includes/seo.html -->


<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/common/favicon_32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/common/favicon_16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/common/favicon_180x180.png">
<link rel="manifest" href="/assets/site.webmanifest">


  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="뭐라도 하겠지 Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<script>
document.addEventListener('DOMContentLoaded', function() {
  const dropdownBtn = document.querySelector('.head-content-btn');
  const dropdownContent = document.querySelector('.game-dropdown-content');
  let isOpen = false;

  // 드롭다운 버튼 클릭 이벤트
  dropdownBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    isOpen = !isOpen;
    if (isOpen) {
      const rect = dropdownBtn.getBoundingClientRect();
      dropdownContent.style.top = rect.bottom + 'px';
      dropdownContent.style.left = rect.left + 'px';
      dropdownContent.classList.add('show');
    } else {
      dropdownContent.classList.remove('show');
    }
  });

  // 외부 클릭 시 드롭다운 닫기
  document.addEventListener('click', function(e) {
    if (isOpen && !dropdownContent.contains(e.target) && !dropdownBtn.contains(e.target)) {
      isOpen = false;
      dropdownContent.classList.remove('show');
    }
  });
});
</script>

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/common/favicon_180x180.png" alt="뭐라도 하겠지"></a>
        
        <a class="site-title" href="/">
          뭐라도 하겠지
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
            <div class="game-dropdown">
              <button class="head-content-btn">
                play <i class="fas fa-caret-down"></i>
              </button>
              <div class="game-dropdown-content">
                <a href="/play/Flappy%20Bird.html" target="_blank">Flappy Bird</a>
                <a href="/play/Minesweeper.html" target="_blank">Minesweeper</a>
                <a href="/play/Random%20Printer.html" target="_blank">Random Printer</a>
                <a href="/play/Maze%20Generator.html" target="_blank">Maze Generator</a>
                <a href="/play/Dungeon%20Generator.html" target="_blank">Dungeon Generator</a>
              </div>
            </div>
          </li>
          <li class="masthead__menu-item">
            <button class="head-content-btn" onclick="window.location.href='/board?path='">
              explorer
            </button>
          </li>
        </ul>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="제목 검색" class="search-input">
          <button class="search-button" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

<!-- 
  <h1 class="title__logo"><a href="https://movingwoo.com/">뭐라도 하겠지</a></h1>
 -->



<script src="/assets/js/search.js"></script>


    <div class="initial-content">
      



<div class="home-layout">
  <div class="home-sidebar">
    







<aside class="sidebar__left">
  <div class="toc-wrapper">
    <nav class="toc">
      <header>
        <h4 class="nav__title">
          <span class="title-text">
            <i class="fas fa-sitemap"></i> Archive
          </span>
          <a href="/board?path=" class="search-link" title="탐색">
            <i class="fas fa-list-ul"></i>
          </a>
        </h4>
      </header>

      <ul class="toc__menu">
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="AI-playground/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">AI-playground</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="AI-playground/Claude/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Claude</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/ai-playground/claude/2025/05/01/Claude.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 즐거운 연휴, 어떻게 보내면 좋을까?
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/claude/2025/04/30/Claude.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> AI 시대의 개발자, 어떻게 준비해야 할까?
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="AI-playground/GPT/" data-total-posts="3">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">GPT</span>
              
              
                <span class="post-count">3</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/ai-playground/gpt/2025/05/14/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 파이썬으로 CLI TODO 리스트 만들어보기
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/gpt/2025/05/01/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 즐거운 연휴
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/gpt/2025/04/30/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 프로그래머를 위한 생산성 툴 TOP 5 🧰
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="one-pan/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">one-pan</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/Java/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Java</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/java/2025/05/11/Bulls-and-Cows.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 숫자야구
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/JavaScript/" data-total-posts="8">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">JavaScript</span>
              
              
                <span class="post-count">8</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/28/Dungeon-Generator-02.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 던전 생성기 02
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/27/Dungeon-Generator-01.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 던전 생성기 01
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/23/Maze-Generator-03.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 미로 생성기 03
                    </a>
                  </li>
                
                
                  <li>
                    <a href="/board?path=one-pan%2FJavaScript%2F" class="toc__link more-posts">
                      <i class="fas fa-ellipsis-h"></i> 더보기
                    </a>
                  </li>
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/Python/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Python</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/python/2025/06/04/WebP-Converter.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> WebP 변환기
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/python/2025/05/13/Clicker.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 클리커
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/ShellScript/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">ShellScript</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/shellscript/2025/05/12/File-Copier.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 파일 복사기
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/shellscript/2025/04/28/Server-Manage-Console.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 서버 관리 콘솔
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/Shortcuts/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Shortcuts</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/shortcuts/2025/06/02/Magic-Conch-Shell.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 마법의 소라고둥
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="random-solve/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">random-solve</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/C++/" data-total-posts="5">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">C++</span>
              
              
                <span class="post-count">5</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/c++/2025/05/30/7663.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 7663번 Dreadful Deadlines
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/c++/2025/05/28/16085.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 16085번 Гэмт хэрэг
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/c++/2025/05/23/25245.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 25245번 Amusement Arcade
                    </a>
                  </li>
                
                
                  <li>
                    <a href="/board?path=random-solve%2FC%2B%2B%2F" class="toc__link more-posts">
                      <i class="fas fa-ellipsis-h"></i> 더보기
                    </a>
                  </li>
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/Java/" data-total-posts="5">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Java</span>
              
              
                <span class="post-count">5</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/java/2025/06/02/1148.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 1148번 단어 만들기
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/java/2025/05/30/6862.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 6862번 Tin Can Telephone
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/java/2025/05/28/11982.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 11982번 Angry Cows (Gold)
                    </a>
                  </li>
                
                
                  <li>
                    <a href="/board?path=random-solve%2FJava%2F" class="toc__link more-posts">
                      <i class="fas fa-ellipsis-h"></i> 더보기
                    </a>
                  </li>
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/Python/" data-total-posts="7">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Python</span>
              
              
                <span class="post-count">7</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/python/2025/06/02/11761.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 11761번 Shuffling Along
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/python/2025/05/30/15654.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 15654번 N과 M (5)
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/python/2025/05/30/21308.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 21308번 Ternary Machine
                    </a>
                  </li>
                
                
                  <li>
                    <a href="/board?path=random-solve%2FPython%2F" class="toc__link more-posts">
                      <i class="fas fa-ellipsis-h"></i> 더보기
                    </a>
                  </li>
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
      </ul>
    </nav>
  </div>
</aside>

<link rel="stylesheet" href="/assets/css/main.css">
<script src="/assets/js/toc.js"></script> 
  </div>

  <div class="home-content">
    <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
      <meta itemprop="headline" content="21308번 Ternary Machine">
      <meta itemprop="description" content="  문제  21308번 Ternary Machine - 백준  번역  롱——문제3진수 프로그램을 해석하고 실행하는 인터프리터를 구현해야한다.명령어는 고정된 형식이 존재하며 표를 참조한다.올바르지 않은 입력에 대해서는 런타임에러를 출력하는데, 실행되지 않는 오류는 무시한다.프로그램은 최대 8192자이며 입력이 필요한 경우 충분한 입력이 반드시 주어진다.  설계  구현문제로 보이는데 생각할 부분이 다소 많아보인다.명령어 해석을 빠르게 처리해야하고스택과 힙을 구현해야하겠고예외처리도 해야하고…주어진 것부터 묵묵히 하다보면 풀리겠지??  구현  1. 입출력과 기본함수입력은 한번에 받아서 버퍼로 저장해둔다.필요하면 버퍼에 하나씩 꺼내 쓰도록 하고출력은 모아뒀다가 한번에 한다.오류 출력시에는 기존 프로그램이 생성한 출력은 먼저 출력해야하는 것에 주의isError = False# 입력 버퍼 탐색 인덱스buffer_index = 0# 프로그램 탐색 인덱스program_index = 0# 명령어 사전opcodes = [    # 4자리 명령부터 판단    # CODE | PARAM | DESCRIPTION    (&quot;1000&quot;, None, &quot;ADD&quot;),    (&quot;1001&quot;, None, &quot;SUB&quot;),    (&quot;1002&quot;, None, &quot;MUL&quot;),    (&quot;1010&quot;, None, &quot;DIV&quot;),    (&quot;1011&quot;, None, &quot;MOD&quot;),    (&quot;1200&quot;, None, &quot;PRINT_CHAR&quot;),    (&quot;1201&quot;, None, &quot;PRINT_NUM&quot;),    (&quot;1210&quot;, None, &quot;READ_CHAR&quot;),    (&quot;1211&quot;, None, &quot;READ_NUM&quot;),    (&quot;000&quot;, &quot;number&quot;, &quot;PUSH_POS&quot;),    (&quot;001&quot;, &quot;number&quot;, &quot;PUSH_NEG&quot;),    (&quot;020&quot;, None, &quot;DUP&quot;),    (&quot;021&quot;, None, &quot;SWAP&quot;),    (&quot;022&quot;, None, &quot;DROP&quot;),    (&quot;110&quot;, None, &quot;STORE&quot;),    (&quot;111&quot;, None, &quot;LOAD&quot;),    (&quot;200&quot;, &quot;label&quot;, &quot;LABEL&quot;),    (&quot;201&quot;, &quot;label&quot;, &quot;CALL&quot;),    (&quot;202&quot;, &quot;label&quot;, &quot;JUMP&quot;),    (&quot;210&quot;, &quot;label&quot;, &quot;JUMP_IF_ZERO&quot;),    (&quot;211&quot;, &quot;label&quot;, &quot;JUMP_IF_NEG&quot;),    (&quot;212&quot;, None, &quot;RETURN&quot;),    (&quot;222&quot;, None, &quot;HALT&quot;),]stack = []heap = {}# 복귀 주소 스택call_stack = []# CALL, JUMP 등을 처리하기 위해 label 위치를 미리 매핑해야함labels = {}# 출력은 리스트에 모아두었다가 한 번에 출력output = []print(&#39;&#39;.join(output), end=&#39;&#39;)if isError:    print(&quot;RUN-TIME ERROR&quot;, end=&#39;&#39;)한자리 숫자, 문자를 읽는 함수, 라벨을 읽는 함수, 프로그램 내 숫자를 읽는 함수가 필요하다.스택에 넣는 부분이 많아서 그부분도 따로 함수로 뺀다.# 버퍼에서 숫자 하나 읽어오는 함수def read_number():    global buffer_index, isError    # 입력에 공백이 주어지나??    while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isspace():        buffer_index += 1    if buffer_index &gt;= len(input_buffer):        isError = True        return 0        start = buffer_index    # 입력 값이 음수일 수 있음    if input_buffer[buffer_index] == &#39;-&#39;:        buffer_index += 1    while buffer_index &lt; len(input_buffer) and input_buffer[buffer_index].isdigit():        buffer_index += 1    if start == buffer_index or (input_buffer[start] == &#39;-&#39; and buffer_index == start + 1):        isError = True        return 0    return int(&#39;&#39;.join(input_buffer[start:buffer_index]))# 버퍼에서 문자 하나 읽어오는 함수def read_char():    global buffer_index, isError    if buffer_index &gt;= len(input_buffer):        isError = True        return 0        ch = input_buffer[buffer_index]    buffer_index += 1    return ord(ch)# 프로그램에서 2로 끝나는 레이블을 읽어오는 함수def read_label():    global program_index, isError    start = program_index    while program_index &lt; len(program):        trit = program[program_index]        if trit == &#39;2&#39;:            label = program[start:program_index]            program_index += 1            return label                elif trit not in &#39;01&#39;:            isError = True            return None                program_index += 1        isError = True    return None# 프로그램 내의 숫자 파싱하는 함수def parse_number_program():    global program_index, isError    bits = []    count = 0    while program_index &lt; len(program):        trit = program[program_index]        if trit == &#39;0&#39; or trit == &#39;1&#39;:            bits.append(trit)            program_index += 1            count += 1            if count &gt; 31:                isError = True                return 0                    elif trit == &#39;2&#39;:            program_index += 1            if not bits:                isError = True                return 0                        return int(&#39;&#39;.join(bits), 2)        else:            isError = True            return 0    isError = True    return 0# 스택에 넣는 함수def push_stack(value):    global stack, isError    if len(stack) &gt;= 1024:        isError = True        return    stack.append(value)# 콜스택에 넣는 함수def push_call_stack(value):    global call_stack, isError    # 서브루틴도 1024 체크 필요    if len(call_stack) &gt;= 1024:        isError = True        return    call_stack.append(value)2. 레이블 스캔 함수CALL이나 JUMP 명령 시 어디로 가야하는가?그것을 미리 알기위해 레이블 스캔을 미리 진행한다.실행 시 찾으려면 비효율적일 것 같아서리섣불리 에러처리 해버리면 에러 전까지의 프로그램 아웃풋이 없으므로 주의해야한다.# label 스캔하는 함수def scan_labels():    global labels, isError    scan_index = 0    while scan_index &lt; len(program):        # 트릿이 아니면 스캔 종료        if program[scan_index] not in &#39;012&#39;:            break                    matched = False        for code, param, description in opcodes:            if program.startswith(code, scan_index):                scan_index += len(code)                matched = True                # HALT 이후까지 스캔하면 불필요한 오류 발생 가능                if description == &quot;HALT&quot;:                    # return 해버리니 뒤쪽 레이블이 등록안됨...                    break                                elif description == &quot;LABEL&quot;:                    # label 읽기                    start = scan_index                    while scan_index &lt; len(program):                        trit = program[scan_index]                        if trit == &#39;2&#39;:                            label = program[start:scan_index]                            scan_index += 1                            if not label or any(c not in &#39;01&#39; for c in label):                                isError = True                                return                                                        if label in labels:                                # 같은 위치에 중복된 레이블이면 허용                                if labels[label] != scan_index:                                    isError = True                                    return                            else:                                # label 다음 위치                                labels[label] = scan_index                            break                        elif trit not in &#39;01&#39;:                            isError = True                            return                        scan_index += 1                    else:                        # 끝까지 2를 못 만남                        isError = True                        return                # 숫자 건너뛰기                elif param == &quot;number&quot;:                    count = 0                    while scan_index &lt; len(program):                        trit = program[scan_index]                        scan_index += 1                        if trit == &#39;2&#39;:                            break                        elif trit not in &#39;01&#39;:                            isError = True                            return                        count += 1                        if count &gt; 31:                            isError = True                            return                # 레이블 건너뛰기                elif param == &quot;label&quot;:                                        while scan_index &lt; len(program):                        trit = program[scan_index]                        scan_index += 1                        if trit == &#39;2&#39;:                            break                        elif trit not in &#39;01&#39;:                            isError = True                            return                # param 없는 경우                break        if not matched:            isError = True            break    return3. 메인 루프명령어 조건에 맞춰 메인 루프 작성가장 단순하고 가장 별거없고 가장 노가다 구간# 본 로직while program_index &lt; len(program) and not isError and not halted:    matched = False        for code, param, description in opcodes:        if program.startswith(code, program_index):            program_index += len(code)            matched = True            # 분기 시작            # ... 중략 ...    if not matched:        # 남은 코드가 공백이거나 무의미하면 무시하고 종료        if program_index &gt;= len(program):            break        else:            isError = True            break  채점    반성  하필 또 파이썬이라 푸는데 엄청 오래 걸린 문제구현만 잘하면 문제없을 줄 알았는데 생각보다 오류가 엄청났다.레이블 스캔하는 부분에서 뜻대로 잘 동작하지 않아서 결과가 자꾸 틀어짐…PyPy는 JIT 컴파일러가 있어서 더 빠르다고해서 Python3와 PyPy3 두개로 제출했다.생각보다 시간 차이가 안나는데, 메모리는 당연히 PyPy3가 많이 쓸거고속도는 연산자체가 그리 많은 문제가 아니라 큰 차이 안나는 것으로 보인다.제한시간 빡빡한 문제에서 다시 한 번 비교해봐야할 듯  코드 확인  Link to GitHub">
      <meta itemprop="datePublished" content="2025-05-30T01:00:00+00:00">
      <meta itemprop="dateModified" content="2025-05-30T01:00:00+00:00">

      <div class="page__inner-wrap">
        
          <header>
            
<div class="post-category">
  <div class="category-path">
    <a href="/board?path=" class="category-link">Archive</a>
    
    
    
      <span class="separator">/</span>
      
      <a href="/board?path=random-solve" class="category-link">
        random-solve
      </a>
      
    
      <span class="separator">/</span>
      
      <a href="/board?path=random-solve%2FPython" class="category-link">
        Python
      </a>
      
    
  </div>
  <a href="/board?path=random-solve%2FPython%2F" class="category-icon" title="리스트">
    <i class="fas fa-list-ul" aria-hidden="true"></i>
  </a>
</div>
 
            <h1 id="page-title" class="page__title" itemprop="headline">21308번 Ternary Machine
</h1>
            


          </header>
        

        <section class="page__content" itemprop="text">
          <blockquote>
  <h4 id="문제">문제</h4>
  <hr />
</blockquote>

<p><img src="/assets/images/posts/random-solve/Python/2025-05-30-21308/img01.webp" alt="img01" /></p>

<p><a href="https://www.acmicpc.net/problem/21308">21308번 Ternary Machine - 백준</a></p>

<blockquote>
  <h4 id="번역">번역</h4>
  <hr />
</blockquote>

<p>롱——문제</p>

<p>3진수 프로그램을 해석하고 실행하는 인터프리터를 구현해야한다.</p>

<p>명령어는 고정된 형식이 존재하며 표를 참조한다.<br />
올바르지 않은 입력에 대해서는 런타임에러를 출력하는데, 실행되지 않는 오류는 무시한다.</p>

<p>프로그램은 최대 8192자이며 입력이 필요한 경우 충분한 입력이 반드시 주어진다.</p>

<blockquote>
  <h4 id="설계">설계</h4>
  <hr />
</blockquote>

<p>구현문제로 보이는데 생각할 부분이 다소 많아보인다.<br />
명령어 해석을 빠르게 처리해야하고<br />
스택과 힙을 구현해야하겠고<br />
예외처리도 해야하고…</p>

<p>주어진 것부터 묵묵히 하다보면 풀리겠지??</p>

<blockquote>
  <h4 id="구현">구현</h4>
  <hr />
</blockquote>

<h5 id="1-입출력과-기본함수">1. 입출력과 기본함수</h5>

<p>입력은 한번에 받아서 버퍼로 저장해둔다.<br />
필요하면 버퍼에 하나씩 꺼내 쓰도록 하고<br />
출력은 모아뒀다가 한번에 한다.</p>

<p><span style="color: orange;"><strong>오류 출력시에는 기존 프로그램이 생성한 출력은 먼저 출력</strong></span>해야하는 것에 주의</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">isError</span> <span class="o">=</span> <span class="bp">False</span>
<span class="c1"># 입력 버퍼 탐색 인덱스
</span><span class="n">buffer_index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># 프로그램 탐색 인덱스
</span><span class="n">program_index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># 명령어 사전
</span><span class="n">opcodes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># 4자리 명령부터 판단
</span>    <span class="c1"># CODE | PARAM | DESCRIPTION
</span>    <span class="p">(</span><span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">ADD</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1001</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">SUB</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1002</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">MUL</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1010</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">DIV</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1011</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">MOD</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1200</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">PRINT_CHAR</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1201</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">PRINT_NUM</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1210</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">READ_CHAR</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">1211</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">READ_NUM</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">000</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">number</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">PUSH_POS</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">001</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">number</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">PUSH_NEG</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">020</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">DUP</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">021</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">SWAP</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">022</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">DROP</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">110</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">STORE</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">111</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">LOAD</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">200</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">LABEL</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">201</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CALL</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">202</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">JUMP</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">210</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">JUMP_IF_ZERO</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">211</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">JUMP_IF_NEG</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">212</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">RETURN</span><span class="sh">"</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">222</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">"</span><span class="s">HALT</span><span class="sh">"</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">heap</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># 복귀 주소 스택
</span><span class="n">call_stack</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># CALL, JUMP 등을 처리하기 위해 label 위치를 미리 매핑해야함
</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># 출력은 리스트에 모아두었다가 한 번에 출력
</span><span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">output</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>

<span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">RUN-TIME ERROR</span><span class="sh">"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
</code></pre></div></div>

<p>한자리 숫자, 문자를 읽는 함수, 라벨을 읽는 함수, 프로그램 내 숫자를 읽는 함수가 필요하다.<br />
스택에 넣는 부분이 많아서 그부분도 따로 함수로 뺀다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 버퍼에서 숫자 하나 읽어오는 함수
</span><span class="k">def</span> <span class="nf">read_number</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">buffer_index</span><span class="p">,</span> <span class="n">isError</span>

    <span class="c1"># 입력에 공백이 주어지나??
</span>    <span class="k">while</span> <span class="n">buffer_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">input_buffer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">input_buffer</span><span class="p">[</span><span class="n">buffer_index</span><span class="p">].</span><span class="nf">isspace</span><span class="p">():</span>
        <span class="n">buffer_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">buffer_index</span> <span class="o">&gt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">input_buffer</span><span class="p">):</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="n">start</span> <span class="o">=</span> <span class="n">buffer_index</span>
    <span class="c1"># 입력 값이 음수일 수 있음
</span>    <span class="k">if</span> <span class="n">input_buffer</span><span class="p">[</span><span class="n">buffer_index</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">buffer_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">buffer_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">input_buffer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">input_buffer</span><span class="p">[</span><span class="n">buffer_index</span><span class="p">].</span><span class="nf">isdigit</span><span class="p">():</span>
        <span class="n">buffer_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">buffer_index</span> <span class="ow">or</span> <span class="p">(</span><span class="n">input_buffer</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">-</span><span class="sh">'</span> <span class="ow">and</span> <span class="n">buffer_index</span> <span class="o">==</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">input_buffer</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">buffer_index</span><span class="p">]))</span>

<span class="c1"># 버퍼에서 문자 하나 읽어오는 함수
</span><span class="k">def</span> <span class="nf">read_char</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">buffer_index</span><span class="p">,</span> <span class="n">isError</span>

    <span class="k">if</span> <span class="n">buffer_index</span> <span class="o">&gt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">input_buffer</span><span class="p">):</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="n">ch</span> <span class="o">=</span> <span class="n">input_buffer</span><span class="p">[</span><span class="n">buffer_index</span><span class="p">]</span>
    <span class="n">buffer_index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nf">ord</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

<span class="c1"># 프로그램에서 2로 끝나는 레이블을 읽어오는 함수
</span><span class="k">def</span> <span class="nf">read_label</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">program_index</span><span class="p">,</span> <span class="n">isError</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">program_index</span>

    <span class="k">while</span> <span class="n">program_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
        <span class="n">trit</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">program_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">program_index</span><span class="p">]</span>
            <span class="n">program_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">label</span>
        
        <span class="k">elif</span> <span class="n">trit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="n">program_index</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="c1"># 프로그램 내의 숫자 파싱하는 함수
</span><span class="k">def</span> <span class="nf">parse_number_program</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">program_index</span><span class="p">,</span> <span class="n">isError</span>
    <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">program_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
        <span class="n">trit</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">program_index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">bits</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">trit</span><span class="p">)</span>
            <span class="n">program_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">:</span>
                <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">return</span> <span class="mi">0</span>
            
        <span class="k">elif</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">program_index</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">bits</span><span class="p">:</span>
                <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">return</span> <span class="mi">0</span>
            
            <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">bits</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="c1"># 스택에 넣는 함수
</span><span class="k">def</span> <span class="nf">push_stack</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">stack</span><span class="p">,</span> <span class="n">isError</span>

    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">:</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span>
    <span class="n">stack</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 콜스택에 넣는 함수
</span><span class="k">def</span> <span class="nf">push_call_stack</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">call_stack</span><span class="p">,</span> <span class="n">isError</span>

    <span class="c1"># 서브루틴도 1024 체크 필요
</span>    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">call_stack</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">:</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span>
    <span class="n">call_stack</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="2-레이블-스캔-함수">2. 레이블 스캔 함수</h5>

<p>CALL이나 JUMP 명령 시 어디로 가야하는가?<br />
그것을 미리 알기위해 <span style="color: orange;"><strong>레이블 스캔을 미리 진행</strong></span>한다.<br />
실행 시 찾으려면 비효율적일 것 같아서리</p>

<p>섣불리 에러처리 해버리면 에러 전까지의 프로그램 아웃풋이 없으므로 주의해야한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># label 스캔하는 함수
</span><span class="k">def</span> <span class="nf">scan_labels</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">labels</span><span class="p">,</span> <span class="n">isError</span>
    <span class="n">scan_index</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="k">while</span> <span class="n">scan_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>

        <span class="c1"># 트릿이 아니면 스캔 종료
</span>        <span class="k">if</span> <span class="n">program</span><span class="p">[</span><span class="n">scan_index</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">012</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">break</span>
            
        <span class="n">matched</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">for</span> <span class="n">code</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">opcodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">program</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">scan_index</span><span class="p">):</span>
                <span class="n">scan_index</span> <span class="o">+=</span> <span class="nf">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
                <span class="n">matched</span> <span class="o">=</span> <span class="bp">True</span>

                <span class="c1"># HALT 이후까지 스캔하면 불필요한 오류 발생 가능
</span>                <span class="k">if</span> <span class="n">description</span> <span class="o">==</span> <span class="sh">"</span><span class="s">HALT</span><span class="sh">"</span><span class="p">:</span>
                    <span class="c1"># return 해버리니 뒤쪽 레이블이 등록안됨...
</span>                    <span class="k">break</span>
                
                <span class="k">elif</span> <span class="n">description</span> <span class="o">==</span> <span class="sh">"</span><span class="s">LABEL</span><span class="sh">"</span><span class="p">:</span>
                    <span class="c1"># label 읽기
</span>                    <span class="n">start</span> <span class="o">=</span> <span class="n">scan_index</span>

                    <span class="k">while</span> <span class="n">scan_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
                        <span class="n">trit</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">scan_index</span><span class="p">]</span>

                        <span class="k">if</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">scan_index</span><span class="p">]</span>
                            <span class="n">scan_index</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">or</span> <span class="nf">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">label</span><span class="p">):</span>
                                <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                                <span class="k">return</span>
                            
                            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                                <span class="c1"># 같은 위치에 중복된 레이블이면 허용
</span>                                <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">!=</span> <span class="n">scan_index</span><span class="p">:</span>
                                    <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                                    <span class="k">return</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># label 다음 위치
</span>                                <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_index</span>
                            <span class="k">break</span>

                        <span class="k">elif</span> <span class="n">trit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span><span class="p">:</span>
                            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">return</span>
                        <span class="n">scan_index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># 끝까지 2를 못 만남
</span>                        <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="k">return</span>

                <span class="c1"># 숫자 건너뛰기
</span>                <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="sh">"</span><span class="s">number</span><span class="sh">"</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

                    <span class="k">while</span> <span class="n">scan_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
                        <span class="n">trit</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">scan_index</span><span class="p">]</span>
                        <span class="n">scan_index</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">if</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="n">trit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span><span class="p">:</span>
                            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">return</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">:</span>
                            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">return</span>

                <span class="c1"># 레이블 건너뛰기
</span>                <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">:</span>
                    
                    <span class="k">while</span> <span class="n">scan_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
                        <span class="n">trit</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">scan_index</span><span class="p">]</span>
                        <span class="n">scan_index</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">if</span> <span class="n">trit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="n">trit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span><span class="p">:</span>
                            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">return</span>

                <span class="c1"># param 없는 경우
</span>                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>

    <span class="k">return</span>
</code></pre></div></div>

<h5 id="3-메인-루프">3. 메인 루프</h5>

<p>명령어 조건에 맞춰 메인 루프 작성<br />
가장 단순하고 가장 별거없고 가장 노가다 구간</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 본 로직
</span><span class="k">while</span> <span class="n">program_index</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isError</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">halted</span><span class="p">:</span>

    <span class="n">matched</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="k">for</span> <span class="n">code</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">opcodes</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">program</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">program_index</span><span class="p">):</span>
            <span class="n">program_index</span> <span class="o">+=</span> <span class="nf">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="n">matched</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="c1"># 분기 시작
</span>
            <span class="c1"># ... 중략 ...
</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
        <span class="c1"># 남은 코드가 공백이거나 무의미하면 무시하고 종료
</span>        <span class="k">if</span> <span class="n">program_index</span> <span class="o">&gt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">isError</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>
</code></pre></div></div>

<blockquote>
  <h4 id="채점">채점</h4>
  <hr />
</blockquote>

<p><img src="/assets/images/posts/random-solve/Python/2025-05-30-21308/img02.webp" alt="img02" /></p>

<blockquote>
  <h4 id="반성">반성</h4>
  <hr />
</blockquote>

<p>하필 또 파이썬이라 푸는데 엄청 오래 걸린 문제</p>

<p>구현만 잘하면 문제없을 줄 알았는데 생각보다 오류가 엄청났다.<br />
레이블 스캔하는 부분에서 뜻대로 잘 동작하지 않아서 결과가 자꾸 틀어짐…</p>

<p>PyPy는 JIT 컴파일러가 있어서 더 빠르다고해서 Python3와 PyPy3 두개로 제출했다.<br />
생각보다 시간 차이가 안나는데, 메모리는 당연히 PyPy3가 많이 쓸거고<br />
속도는 연산자체가 그리 많은 문제가 아니라 큰 차이 안나는 것으로 보인다.</p>

<p>제한시간 빡빡한 문제에서 다시 한 번 비교해봐야할 듯</p>

<blockquote>
  <h4 id="코드-확인">코드 확인</h4>
  <hr />
</blockquote>

<p><a href="https://raw.githubusercontent.com/movingwoo/movingwoo-snippets/refs/heads/main/random-solve/Python/2025-05-30-21308.py">Link to GitHub</a></p>

          
        </section>

        <footer class="page__meta">
          
          

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-05-30">May 30, 2025</time></p>


        </footer>

        

        
<nav class="post-navigation">
  <div id="postNavigation" class="post-navigation__container"></div>

  <script>
    // 별도 js로 post data 넘겨주기만
    window.postData = {
      currentPost: {
        title: "21308번 Ternary Machine",
        url: "/random-solve/python/2025/05/30/21308.html",
        date: "2025-05-30",
        categories: ["random-solve/Python/"]
      },
      allPosts: [
        
        
          
          
          {
            title: "WebP 변환기",
            url: "/one-pan/python/2025/06/04/WebP-Converter.html",
            date: "2025-06-04",
            categories: ["one-pan/Python/"]
          },
          
        
          
          
          {
            title: "마법의 소라고둥",
            url: "/one-pan/shortcuts/2025/06/02/Magic-Conch-Shell.html",
            date: "2025-06-02",
            categories: ["one-pan/Shortcuts/"]
          },
          
        
          
          
          {
            title: "1148번 단어 만들기",
            url: "/random-solve/java/2025/06/02/1148.html",
            date: "2025-06-02",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "11761번 Shuffling Along",
            url: "/random-solve/python/2025/06/02/11761.html",
            date: "2025-06-02",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "7663번 Dreadful Deadlines",
            url: "/random-solve/c++/2025/05/30/7663.html",
            date: "2025-05-30",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "6862번 Tin Can Telephone",
            url: "/random-solve/java/2025/05/30/6862.html",
            date: "2025-05-30",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "15654번 N과 M (5)",
            url: "/random-solve/python/2025/05/30/15654.html",
            date: "2025-05-30",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "21308번 Ternary Machine",
            url: "/random-solve/python/2025/05/30/21308.html",
            date: "2025-05-30",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "11982번 Angry Cows (Gold)",
            url: "/random-solve/java/2025/05/28/11982.html",
            date: "2025-05-28",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "16085번 Гэмт хэрэг",
            url: "/random-solve/c++/2025/05/28/16085.html",
            date: "2025-05-28",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "던전 생성기 02",
            url: "/one-pan/javascript/2025/05/28/Dungeon-Generator-02.html",
            date: "2025-05-28",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "7106번 Wonderful Fours",
            url: "/random-solve/python/2025/05/27/7106.html",
            date: "2025-05-27",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "던전 생성기 01",
            url: "/one-pan/javascript/2025/05/27/Dungeon-Generator-01.html",
            date: "2025-05-27",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "5101번 Sequences",
            url: "/random-solve/python/2025/05/23/5101.html",
            date: "2025-05-23",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "27391번 Platform Placing",
            url: "/random-solve/java/2025/05/23/27391.html",
            date: "2025-05-23",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "25245번 Amusement Arcade",
            url: "/random-solve/c++/2025/05/23/25245.html",
            date: "2025-05-23",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "미로 생성기 03",
            url: "/one-pan/javascript/2025/05/23/Maze-Generator-03.html",
            date: "2025-05-23",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "26489번 Gum Gum for Jay Jay",
            url: "/random-solve/python/2025/05/22/26489.html",
            date: "2025-05-22",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "미로 생성기 02",
            url: "/one-pan/javascript/2025/05/21/Maze-Generator-02.html",
            date: "2025-05-21",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "26226번 Autocomplete",
            url: "/random-solve/c++/2025/05/21/26226.html",
            date: "2025-05-21",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "미로 생성기 01",
            url: "/one-pan/javascript/2025/05/20/Maze-Generator-01.html",
            date: "2025-05-20",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "15936번 Hypercube",
            url: "/random-solve/java/2025/05/20/15936.html",
            date: "2025-05-20",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "29348번 Скользкий путь",
            url: "/random-solve/c++/2025/05/16/29348.html",
            date: "2025-05-16",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "18382번 2048",
            url: "/random-solve/python/2025/05/15/18382.html",
            date: "2025-05-15",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "랜덤 출력기",
            url: "/one-pan/javascript/2025/05/14/Random-Printer.html",
            date: "2025-05-14",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "파이썬으로 CLI TODO 리스트 만들어보기",
            url: "/ai-playground/gpt/2025/05/14/GPT.html",
            date: "2025-05-14",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "플래피 버드",
            url: "/one-pan/javascript/2025/05/13/Flappy-Bird.html",
            date: "2025-05-13",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "클리커",
            url: "/one-pan/python/2025/05/13/Clicker.html",
            date: "2025-05-13",
            categories: ["one-pan/Python/"]
          },
          
        
          
          
          {
            title: "파일 복사기",
            url: "/one-pan/shellscript/2025/05/12/File-Copier.html",
            date: "2025-05-12",
            categories: ["one-pan/ShellScript/"]
          },
          
        
          
          
          {
            title: "숫자야구",
            url: "/one-pan/java/2025/05/11/Bulls-and-Cows.html",
            date: "2025-05-11",
            categories: ["one-pan/Java/"]
          },
          
        
          
          
          {
            title: "즐거운 연휴",
            url: "/ai-playground/gpt/2025/05/01/GPT.html",
            date: "2025-05-01",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "즐거운 연휴, 어떻게 보내면 좋을까?",
            url: "/ai-playground/claude/2025/05/01/Claude.html",
            date: "2025-05-01",
            categories: ["AI-playground/Claude/"]
          },
          
        
          
          
          {
            title: "프로그래머를 위한 생산성 툴 TOP 5 🧰",
            url: "/ai-playground/gpt/2025/04/30/GPT.html",
            date: "2025-04-30",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "AI 시대의 개발자, 어떻게 준비해야 할까?",
            url: "/ai-playground/claude/2025/04/30/Claude.html",
            date: "2025-04-30",
            categories: ["AI-playground/Claude/"]
          },
          
        
          
          
          {
            title: "지뢰찾기",
            url: "/one-pan/javascript/2025/04/29/Minesweeper.html",
            date: "2025-04-29",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "서버 관리 콘솔",
            url: "/one-pan/shellscript/2025/04/28/Server-Manage-Console.html",
            date: "2025-04-28",
            categories: ["one-pan/ShellScript/"]
          }
          
        
      ]
    };
  </script>
  <script src="/assets/js/post_pagination.js" defer></script>
</nav>

      </div>

      
      
      
        <script src="https://giscus.app/client.js"
        data-repo="movingwoo/movingwoo.github.io"
        data-repo-id="R_kgDOORY1lQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOORY1lc4CpoFq"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="https://movingwoo.com/assets/css/giscus-theme.css"
        data-lang="ko"
        crossorigin="anonymous"
        async>
</script>
      
    </article>

    
    
  </div>
</div>

<style>
.home-layout {
  display: flex;
  max-width: 1500px;
  margin: 0 auto;
  padding: 0;
}

.home-sidebar {
  flex-shrink: 0;
  width: 300px;
  margin-right: 1rem;
  position: relative;
  display: block !important;
}

.home-content {
  flex-grow: 1;
  min-width: 0;
  width: 100%;
}

@media (max-width: 64em) {
  .home-layout {
    flex-direction: column;
  }
  
  .home-sidebar {
    width: 100%;
    margin-right: 0;
    margin-bottom: 1rem;
  }
  
  .home-content {
    padding: 0;
  }
}
</style>

    </div>

    
    
    <div class="page__footer">
  <div class="page__footer-copyright">
    Visit: <a href="https://github.com/movingwoo/movingwoo.github.io">https://github.com/movingwoo/movingwoo.github.io</a>
    <br>
    <span class="theme-credit">Theme customized from Minimal Mistakes by Michael Rose (MIT License).</span>
  </div>
</div>

    <div class="scroll-button">
  <div class="scroll-button__container">
    <button class="scroll-button__area scroll-button__area--top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="위로">
      <i class="fas fa-arrow-up"></i>
    </button>
    <button class="scroll-button__area scroll-button__area--bottom" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})" title="아래로">
      <i class="fas fa-arrow-down"></i>
    </button>
  </div>
</div>

<style>
.scroll-button {
  position: fixed;
  right: 20px;
  bottom: 20px;
  z-index: 1000;
}

.scroll-button__container {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid rgba(220, 20, 60, 0.6);
  background-color: transparent;
  position: relative;
  overflow: hidden;
}

.scroll-button__area {
  position: absolute;
  width: 100%;
  height: 50%;
  left: 0;
  background: transparent;
  border: none;
  color: rgba(220, 20, 60, 0.6);
  cursor: pointer;
  padding: 0;
  transition: all 0.3s ease;
  outline: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scroll-button__area--top {
  top: 0;
}

.scroll-button__area--bottom {
  bottom: 0;
}

.scroll-button__area:focus {
  outline: none;
}

.scroll-button__area:hover {
  color: rgba(220, 20, 60, 1);
}

.scroll-button__area:hover i {
  transform: scale(1.2);
}

.scroll-button__area i {
  font-size: 1rem;
  transition: transform 0.3s ease;
}

@media (max-width: 768px) {
  .scroll-button {
    right: 10px;
    bottom: 10px;
  }
  
  .scroll-button__container {
    width: 50px;
    height: 50px;
  }
}
</style> 
    
  <script src="/assets/js/main.min.js"></script>









<script>
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});
document.addEventListener('copy', function(e) {
    e.preventDefault();
});
</script>


  </body>
</html>
