<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>15936번 Hypercube - 뭐라도 하겠지</title>
<meta name="description" content="문제        15936번 Hypercube - 백준     설계      앗 영어문제 아니 진짜 뭔 이딴문제만 걸리냐?  시간제한이 0.2초인데 이거 자바로 되나 싶었는데 푼 사람 목록보니 파이썬도 있다. 알고리즘 잘 짜면 자바도 되겠지 뭐…  입력으로 N, M, K를 준다.    N: N차원 하이퍼 큐브   M: 노드 번호   K: 경로 길이   하이퍼 큐브가 머에여??? 초입방체 - 나무위키  2^N개의 노드를 가지며 x에서 y로 가려면 x &lt; y 이고 xor 연산 시 2^p가 되어야 한다.(비트가 하나 다르다.) 라고 문제에서 말해줌.  문제가 요구하는 건 3가지인데 a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값 b. M 번 노드에서 시작하는 간선이 향하는 노드 번호의 최소값 c. 찾을 수 있는 K-길이의(K개의 간선을 포함하는) 경로의 개수. 100003 나머지 연산.  허허 이게 국어가 맞나  딱 봐도 하이퍼 큐브를 구현하면 제한 시간에 걸려 터진다. 더 좋은 수학실력이 필요하다는 뜻임…  구글링으로 수학 고수들을 통해 문제 해결 공식을 얻은 다음 구현은 내가 하는 쪽으로 한다. 나 혼자서는 풀 수 없음…     구현      1. 입력 받기  Scanner 사용하면 터질 것 같으니 버퍼로 입력 받는다.  public static void main(String[] args) {     try(BufferedReader br = new BufferedReader(new InputStreamReader(System.in));         BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out))) {                  StringTokenizer st = new StringTokenizer(br.readLine(), &quot; &quot;);         int N = Integer.parseInt(st.nextToken());         int M = Integer.parseInt(st.nextToken());         int K = Integer.parseInt(st.nextToken());              }catch(IOException e) {         e.printStackTrace();     } }   2. a번 문제  a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값  일단 M번 노드로 향하는 거니 M보다 작은 노드가 범인이다. 어차피 모든 노드는 작은 수에서 큰 수로 이어지니 M번 노드보다 하나 작은, xor 연산에서 비트 하나 다른 놈을 찾아야한다. 반복문으로 1인 비트를 반전시켜서 비교한다.  // a번: 이진수 M의 1을 반전시킨 수 중 최대값 // 최대값 저장용 int a = Integer.MIN_VALUE; // 0번째 비트부터 올라감, 100,000,000는 27비트 for (int i = 0 ; i &lt; 27 ; i++){     // M의 i번째 비트가 1인 경우     // == 1 할 경우 0번째 비트만 체크해서 오류 발생     //if ((M &amp; (1 &lt;&lt; i)) == 1) {     if ((M &amp; (1 &lt;&lt; i)) != 0) {         int m = M ^ (1 &lt;&lt; i); // 반전                  if (m &lt; M &amp;&amp; m &gt; a) {             a = m;         }     } }   3. b번 문제  a번이랑 비슷한데, 각 비트를 반전시켜서 최소값을 찾으면 된다.  // b번: M의 비트 하나를 반전시킨 수 중 M보다 큰 최소값 찾기 // 최소값 저장용 int b = Integer.MAX_VALUE;  for (int i = 0 ; i &lt; 27 ; i++){     // i번째 비트를 반전시킨 숫자     int m = M ^ (1 &lt;&lt; i);     if (m &gt; M &amp;&amp; b &gt; m) {         b = m;     } }   4. c번 문제  해밍 무게 변화에 따른 경로 수를 구하는 것. 전이 관계를 행렬 형태로 표현한 뒤, 행렬 거듭제곱을 통해 빠르게 K 단계를 계산한다. 즉, 전체 시스템을 크기 N+1의 전이 행렬로 보고, dpK = T^K * dp₀ 형태로 계산하는 것이다!  엄….  좋아 완벽하게 이해했어!!  일단 시간복잡도가 O(NK)면 절대 통과하지 못한다. O(N log K)로 바꾸면 통과가 가능하다.  // c번: 공식계산 doFactorials(N);  // 초기 상태 dp0: 해밍 무게 w를 가진 노드 수 = C(N, w) int[] dp = new int[N + 1]; for (int w = 0; w &lt;= N; w++) {     dp[w] = C(N, w); }  // 전이 행렬 생성 (희소 형태로) List&lt;List&lt;Pair&gt;&gt; T = new ArrayList&lt;&gt;(); for (int i = 0; i &lt;= N; i++) {     T.add(new ArrayList&lt;&gt;()); }  for (int w = 0; w &lt; N; w++) {     // 해밍 무게가 w인 노드에서 w+1로 갈 수 있는 경우만 존재     T.get(w + 1).add(new Pair(w, N - w)); }  // 희소 행렬 거듭제곱을 dp에 적용 int[] dpK = sparseMatPowApply(T, dp, K, N + 1);  // 모든 해밍 무게에서 끝나는 경로 수 합 int c = 0; for (int w = 0; w &lt;= N; w++) {     c = (c + dpK[w]) % 100003; }  // ... 중략 ...  // 거듭제곱 계산 public static int P(int b, int e) {     int r = 1;     while (e &gt; 0) {         if ((e &amp; 1) == 1) {             // 거듭제곱 계산             r = (int)((1L * r * b) % 100003);         }         b = (int)((1L * b * b) % 100003);         e &gt;&gt;= 1;     }     return r; }  // 팩토리얼 및 역팩토리얼 계산 (페르마 소정리 활용) public static void doFactorials(int N) {     factorial = new int[N + 1];     invFactorial = new int[N + 1];     factorial[0] = 1;      for (int i = 1; i &lt;= N; i++) {         // 팩토리얼 계산         factorial[i] = (int)((1L * factorial[i - 1] * i) % 100003);     }      // 역팩토리얼 (페르마의 소정리)     invFactorial[N] = P(factorial[N], 100003 - 2);     for (int i = N - 1; i &gt;= 0; i--) {         // 역팩토리얼 누적 계산         invFactorial[i] = (int)((1L * invFactorial[i + 1] * (i + 1)) % 100003);     } }  // 이항계수 계산 public static int C(int N, int w) {     if (w &lt; 0 || w &gt; N) {         return 0;     }     // C(n, r) 계산     return (int)(1L * factorial[N] * invFactorial[w] % 100003 * invFactorial[N - w] % 100003); }  // 희소행렬 형태: 각 행마다 (열, 값) 쌍 저장 public static class Pair {     int col, val;     Pair(int col, int val) {         this.col = col;         this.val = val;     } }  // 희소 행렬 곱셈 public static int[] sparseMatVecMul(List&lt;List&lt;Pair&gt;&gt; mat, int[] vec, int size) {     int[] res = new int[size];     for (int i = 0; i &lt; size; i++) {         for (Pair p : mat.get(i)) {             res[i] = (int)((res[i] + 1L * p.val * vec[p.col]) % 100003);         }     }     return res; }  // 희소 행렬 거듭제곱과 곱셈 public static int[] sparseMatPowApply(List&lt;List&lt;Pair&gt;&gt; T, int[] vec, int exp, int size) {     // 초기 단위 행렬 적용: vec는 dp로 시작     while (exp &gt; 0) {         if ((exp &amp; 1) == 1) {             vec = sparseMatVecMul(T, vec, size);         }          // T = T * T (희소 곱)         List&lt;List&lt;Pair&gt;&gt; newT = new ArrayList&lt;&gt;();         for (int i = 0; i &lt; size; i++) {             newT.add(new ArrayList&lt;&gt;());         }          for (int i = 0; i &lt; size; i++) {             for (Pair kv1 : T.get(i)) {                 for (Pair kv2 : T.get(kv1.col)) {                     int val = (int)((1L * kv1.val * kv2.val) % 100003);                     newT.get(i).add(new Pair(kv2.col, val));                 }             }         }          // 중복 열 통합         for (int i = 0; i &lt; size; i++) {             if (newT.get(i).isEmpty()) continue;             List&lt;Pair&gt; row = newT.get(i);             row.sort(Comparator.comparingInt(p -&gt; p.col));              List&lt;Pair&gt; compressed = new ArrayList&lt;&gt;();             int lastCol = -1, sum = 0;             for (Pair p : row) {                 if (p.col == lastCol) {                     sum = (sum + p.val) % 100003;                 } else {                     if (lastCol != -1) compressed.add(new Pair(lastCol, sum));                     lastCol = p.col;                     sum = p.val;                 }             }             if (lastCol != -1) compressed.add(new Pair(lastCol, sum));             newT.set(i, compressed);         }          T = newT;         exp &gt;&gt;= 1;     }      return vec; }      채점           반성      c번에서 계속 시간초과 나길래 C++로 돌려보고 로직 문제란걸 깨닫고 구글링했다. 내 힘으로 풀 수 있는 문제가 아니었다. 수학공부한 셈 쳐야지 뭐.     코드 확인      Link to GitHub">



<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="뭐라도 하겠지">
<meta property="og:title" content="15936번 Hypercube">
<meta property="og:url" content="https://movingwoo.com/random-solve/java/2025/05/20/15936.html">


  <meta property="og:description" content="문제        15936번 Hypercube - 백준     설계      앗 영어문제 아니 진짜 뭔 이딴문제만 걸리냐?  시간제한이 0.2초인데 이거 자바로 되나 싶었는데 푼 사람 목록보니 파이썬도 있다. 알고리즘 잘 짜면 자바도 되겠지 뭐…  입력으로 N, M, K를 준다.    N: N차원 하이퍼 큐브   M: 노드 번호   K: 경로 길이   하이퍼 큐브가 머에여??? 초입방체 - 나무위키  2^N개의 노드를 가지며 x에서 y로 가려면 x &lt; y 이고 xor 연산 시 2^p가 되어야 한다.(비트가 하나 다르다.) 라고 문제에서 말해줌.  문제가 요구하는 건 3가지인데 a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값 b. M 번 노드에서 시작하는 간선이 향하는 노드 번호의 최소값 c. 찾을 수 있는 K-길이의(K개의 간선을 포함하는) 경로의 개수. 100003 나머지 연산.  허허 이게 국어가 맞나  딱 봐도 하이퍼 큐브를 구현하면 제한 시간에 걸려 터진다. 더 좋은 수학실력이 필요하다는 뜻임…  구글링으로 수학 고수들을 통해 문제 해결 공식을 얻은 다음 구현은 내가 하는 쪽으로 한다. 나 혼자서는 풀 수 없음…     구현      1. 입력 받기  Scanner 사용하면 터질 것 같으니 버퍼로 입력 받는다.  public static void main(String[] args) {     try(BufferedReader br = new BufferedReader(new InputStreamReader(System.in));         BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out))) {                  StringTokenizer st = new StringTokenizer(br.readLine(), &quot; &quot;);         int N = Integer.parseInt(st.nextToken());         int M = Integer.parseInt(st.nextToken());         int K = Integer.parseInt(st.nextToken());              }catch(IOException e) {         e.printStackTrace();     } }   2. a번 문제  a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값  일단 M번 노드로 향하는 거니 M보다 작은 노드가 범인이다. 어차피 모든 노드는 작은 수에서 큰 수로 이어지니 M번 노드보다 하나 작은, xor 연산에서 비트 하나 다른 놈을 찾아야한다. 반복문으로 1인 비트를 반전시켜서 비교한다.  // a번: 이진수 M의 1을 반전시킨 수 중 최대값 // 최대값 저장용 int a = Integer.MIN_VALUE; // 0번째 비트부터 올라감, 100,000,000는 27비트 for (int i = 0 ; i &lt; 27 ; i++){     // M의 i번째 비트가 1인 경우     // == 1 할 경우 0번째 비트만 체크해서 오류 발생     //if ((M &amp; (1 &lt;&lt; i)) == 1) {     if ((M &amp; (1 &lt;&lt; i)) != 0) {         int m = M ^ (1 &lt;&lt; i); // 반전                  if (m &lt; M &amp;&amp; m &gt; a) {             a = m;         }     } }   3. b번 문제  a번이랑 비슷한데, 각 비트를 반전시켜서 최소값을 찾으면 된다.  // b번: M의 비트 하나를 반전시킨 수 중 M보다 큰 최소값 찾기 // 최소값 저장용 int b = Integer.MAX_VALUE;  for (int i = 0 ; i &lt; 27 ; i++){     // i번째 비트를 반전시킨 숫자     int m = M ^ (1 &lt;&lt; i);     if (m &gt; M &amp;&amp; b &gt; m) {         b = m;     } }   4. c번 문제  해밍 무게 변화에 따른 경로 수를 구하는 것. 전이 관계를 행렬 형태로 표현한 뒤, 행렬 거듭제곱을 통해 빠르게 K 단계를 계산한다. 즉, 전체 시스템을 크기 N+1의 전이 행렬로 보고, dpK = T^K * dp₀ 형태로 계산하는 것이다!  엄….  좋아 완벽하게 이해했어!!  일단 시간복잡도가 O(NK)면 절대 통과하지 못한다. O(N log K)로 바꾸면 통과가 가능하다.  // c번: 공식계산 doFactorials(N);  // 초기 상태 dp0: 해밍 무게 w를 가진 노드 수 = C(N, w) int[] dp = new int[N + 1]; for (int w = 0; w &lt;= N; w++) {     dp[w] = C(N, w); }  // 전이 행렬 생성 (희소 형태로) List&lt;List&lt;Pair&gt;&gt; T = new ArrayList&lt;&gt;(); for (int i = 0; i &lt;= N; i++) {     T.add(new ArrayList&lt;&gt;()); }  for (int w = 0; w &lt; N; w++) {     // 해밍 무게가 w인 노드에서 w+1로 갈 수 있는 경우만 존재     T.get(w + 1).add(new Pair(w, N - w)); }  // 희소 행렬 거듭제곱을 dp에 적용 int[] dpK = sparseMatPowApply(T, dp, K, N + 1);  // 모든 해밍 무게에서 끝나는 경로 수 합 int c = 0; for (int w = 0; w &lt;= N; w++) {     c = (c + dpK[w]) % 100003; }  // ... 중략 ...  // 거듭제곱 계산 public static int P(int b, int e) {     int r = 1;     while (e &gt; 0) {         if ((e &amp; 1) == 1) {             // 거듭제곱 계산             r = (int)((1L * r * b) % 100003);         }         b = (int)((1L * b * b) % 100003);         e &gt;&gt;= 1;     }     return r; }  // 팩토리얼 및 역팩토리얼 계산 (페르마 소정리 활용) public static void doFactorials(int N) {     factorial = new int[N + 1];     invFactorial = new int[N + 1];     factorial[0] = 1;      for (int i = 1; i &lt;= N; i++) {         // 팩토리얼 계산         factorial[i] = (int)((1L * factorial[i - 1] * i) % 100003);     }      // 역팩토리얼 (페르마의 소정리)     invFactorial[N] = P(factorial[N], 100003 - 2);     for (int i = N - 1; i &gt;= 0; i--) {         // 역팩토리얼 누적 계산         invFactorial[i] = (int)((1L * invFactorial[i + 1] * (i + 1)) % 100003);     } }  // 이항계수 계산 public static int C(int N, int w) {     if (w &lt; 0 || w &gt; N) {         return 0;     }     // C(n, r) 계산     return (int)(1L * factorial[N] * invFactorial[w] % 100003 * invFactorial[N - w] % 100003); }  // 희소행렬 형태: 각 행마다 (열, 값) 쌍 저장 public static class Pair {     int col, val;     Pair(int col, int val) {         this.col = col;         this.val = val;     } }  // 희소 행렬 곱셈 public static int[] sparseMatVecMul(List&lt;List&lt;Pair&gt;&gt; mat, int[] vec, int size) {     int[] res = new int[size];     for (int i = 0; i &lt; size; i++) {         for (Pair p : mat.get(i)) {             res[i] = (int)((res[i] + 1L * p.val * vec[p.col]) % 100003);         }     }     return res; }  // 희소 행렬 거듭제곱과 곱셈 public static int[] sparseMatPowApply(List&lt;List&lt;Pair&gt;&gt; T, int[] vec, int exp, int size) {     // 초기 단위 행렬 적용: vec는 dp로 시작     while (exp &gt; 0) {         if ((exp &amp; 1) == 1) {             vec = sparseMatVecMul(T, vec, size);         }          // T = T * T (희소 곱)         List&lt;List&lt;Pair&gt;&gt; newT = new ArrayList&lt;&gt;();         for (int i = 0; i &lt; size; i++) {             newT.add(new ArrayList&lt;&gt;());         }          for (int i = 0; i &lt; size; i++) {             for (Pair kv1 : T.get(i)) {                 for (Pair kv2 : T.get(kv1.col)) {                     int val = (int)((1L * kv1.val * kv2.val) % 100003);                     newT.get(i).add(new Pair(kv2.col, val));                 }             }         }          // 중복 열 통합         for (int i = 0; i &lt; size; i++) {             if (newT.get(i).isEmpty()) continue;             List&lt;Pair&gt; row = newT.get(i);             row.sort(Comparator.comparingInt(p -&gt; p.col));              List&lt;Pair&gt; compressed = new ArrayList&lt;&gt;();             int lastCol = -1, sum = 0;             for (Pair p : row) {                 if (p.col == lastCol) {                     sum = (sum + p.val) % 100003;                 } else {                     if (lastCol != -1) compressed.add(new Pair(lastCol, sum));                     lastCol = p.col;                     sum = p.val;                 }             }             if (lastCol != -1) compressed.add(new Pair(lastCol, sum));             newT.set(i, compressed);         }          T = newT;         exp &gt;&gt;= 1;     }      return vec; }      채점           반성      c번에서 계속 시간초과 나길래 C++로 돌려보고 로직 문제란걸 깨닫고 구글링했다. 내 힘으로 풀 수 있는 문제가 아니었다. 수학공부한 셈 쳐야지 뭐.     코드 확인      Link to GitHub">







  <meta property="article:published_time" content="2025-05-20T00:00:00+00:00">



  <meta property="article:modified_time" content="2025-05-20T00:00:00+00:00">




<link rel="canonical" href="https://movingwoo.com/random-solve/java/2025/05/20/15936.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "뭐라도 하겠지",
      "url": "https://movingwoo.com/"
    
  }
</script>







<!-- end _includes/seo.html -->


<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/common/favicon_32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/common/favicon_16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/common/favicon_180x180.png">
<link rel="manifest" href="/assets/site.webmanifest">


  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="뭐라도 하겠지 Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<script>
document.addEventListener('DOMContentLoaded', function() {
  const dropdownBtn = document.querySelector('.head-content-btn');
  const dropdownContent = document.querySelector('.game-dropdown-content');
  let isOpen = false;

  // 드롭다운 버튼 클릭 이벤트
  dropdownBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    isOpen = !isOpen;
    if (isOpen) {
      const rect = dropdownBtn.getBoundingClientRect();
      dropdownContent.style.top = rect.bottom + 'px';
      dropdownContent.style.left = rect.left + 'px';
      dropdownContent.classList.add('show');
    } else {
      dropdownContent.classList.remove('show');
    }
  });

  // 외부 클릭 시 드롭다운 닫기
  document.addEventListener('click', function(e) {
    if (isOpen && !dropdownContent.contains(e.target) && !dropdownBtn.contains(e.target)) {
      isOpen = false;
      dropdownContent.classList.remove('show');
    }
  });
});
</script>

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/common/favicon_180x180.png" alt="뭐라도 하겠지"></a>
        
        <a class="site-title" href="/">
          뭐라도 하겠지
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
            <div class="game-dropdown">
              <button class="head-content-btn">
                play <i class="fas fa-caret-down"></i>
              </button>
              <div class="game-dropdown-content">
                <a href="/play/Flappy%20Bird.html" target="_blank">Flappy Bird</a>
                <a href="/play/Minesweeper.html" target="_blank">Minesweeper</a>
                <a href="/play/Random%20Printer.html" target="_blank">Random Printer</a>
                <a href="/play/Maze%20Generator.html" target="_blank">Maze Generator</a>
              </div>
            </div>
          </li>
          <li class="masthead__menu-item">
            <button class="head-content-btn" onclick="window.location.href='/board?path='">
              explorer
            </button>
          </li>
        </ul>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="제목 검색" class="search-input">
          <button class="search-button" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

<!-- 
  <h1 class="title__logo"><a href="https://movingwoo.com/">뭐라도 하겠지</a></h1>
 -->



<script src="/assets/js/search.js"></script>


    <div class="initial-content">
      



<div class="home-layout">
  <div class="home-sidebar">
    







<aside class="sidebar__left">
  <div class="toc-wrapper">
    <nav class="toc">
      <header>
        <h4 class="nav__title">
          <span class="title-text">
            <i class="fas fa-sitemap"></i> Archive
          </span>
          <a href="/board?path=" class="search-link" title="탐색">
            <i class="fas fa-list-ul"></i>
          </a>
        </h4>
      </header>

      <ul class="toc__menu">
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="AI-playground/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">AI-playground</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="AI-playground/Claude/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Claude</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/ai-playground/claude/2025/05/01/Claude.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 즐거운 연휴, 어떻게 보내면 좋을까?
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/claude/2025/04/30/Claude.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> AI 시대의 개발자, 어떻게 준비해야 할까?
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="AI-playground/GPT/" data-total-posts="3">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">GPT</span>
              
              
                <span class="post-count">3</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/ai-playground/gpt/2025/05/14/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 파이썬으로 CLI TODO 리스트 만들어보기
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/gpt/2025/05/01/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 즐거운 연휴
                    </a>
                  </li>
                
                  <li>
                    <a href="/ai-playground/gpt/2025/04/30/GPT.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 프로그래머를 위한 생산성 툴 TOP 5 🧰
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="one-pan/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">one-pan</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/Java/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Java</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/java/2025/05/11/Bulls-and-Cows.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 숫자야구
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/JavaScript/" data-total-posts="6">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">JavaScript</span>
              
              
                <span class="post-count">6</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/23/Maze-Generator-03.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 미로 생성기 03
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/21/Maze-Generator-02.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 미로 생성기 02
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/javascript/2025/05/20/Maze-Generator-01.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 미로 생성기 01
                    </a>
                  </li>
                
                
                  <li>
                    <a href="/board?path=one-pan%2FJavaScript%2F" class="toc__link more-posts">
                      <i class="fas fa-ellipsis-h"></i> 더보기
                    </a>
                  </li>
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/Python/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Python</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/python/2025/05/13/Clicker.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 클리커
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/ShellScript/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">ShellScript</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/shellscript/2025/05/12/File-Copier.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 파일 복사기
                    </a>
                  </li>
                
                  <li>
                    <a href="/one-pan/shellscript/2025/04/28/Server-Manage-Console.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 서버 관리 콘솔
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="random-solve/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">random-solve</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/C++/" data-total-posts="3">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">C++</span>
              
              
                <span class="post-count">3</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/c++/2025/05/23/25245.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 25245번 Amusement Arcade
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/c++/2025/05/21/26226.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 26226번 Autocomplete
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/c++/2025/05/16/29348.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 29348번 Скользкий путь
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/Java/" data-total-posts="2">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Java</span>
              
              
                <span class="post-count">2</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/java/2025/05/23/27391.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 27391번 Platform Placing
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/java/2025/05/20/15936.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 15936번 Hypercube
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="random-solve/Python/" data-total-posts="3">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">Python</span>
              
              
                <span class="post-count">3</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/random-solve/python/2025/05/23/5101.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 5101번 Sequences
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/python/2025/05/22/26489.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 26489번 Gum Gum for Jay Jay
                    </a>
                  </li>
                
                  <li>
                    <a href="/random-solve/python/2025/05/15/18382.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 18382번 2048
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </li>
        
      </ul>
    </nav>
  </div>
</aside>

<link rel="stylesheet" href="/assets/css/main.css">
<script src="/assets/js/toc.js"></script> 
  </div>

  <div class="home-content">
    <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
      <meta itemprop="headline" content="15936번 Hypercube">
      <meta itemprop="description" content="  문제  15936번 Hypercube - 백준  설계  앗 영어문제아니 진짜 뭔 이딴문제만 걸리냐?시간제한이 0.2초인데 이거 자바로 되나 싶었는데 푼 사람 목록보니 파이썬도 있다.알고리즘 잘 짜면 자바도 되겠지 뭐…입력으로 N, M, K를 준다.  N: N차원 하이퍼 큐브  M: 노드 번호  K: 경로 길이하이퍼 큐브가 머에여???초입방체 - 나무위키2^N개의 노드를 가지며 x에서 y로 가려면 x &lt; y 이고 xor 연산 시 2^p가 되어야 한다.(비트가 하나 다르다.)라고 문제에서 말해줌.문제가 요구하는 건 3가지인데a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값b. M 번 노드에서 시작하는 간선이 향하는 노드 번호의 최소값c. 찾을 수 있는 K-길이의(K개의 간선을 포함하는) 경로의 개수. 100003 나머지 연산.허허 이게 국어가 맞나딱 봐도 하이퍼 큐브를 구현하면 제한 시간에 걸려 터진다.더 좋은 수학실력이 필요하다는 뜻임…구글링으로 수학 고수들을 통해 문제 해결 공식을 얻은 다음 구현은 내가 하는 쪽으로 한다.나 혼자서는 풀 수 없음…  구현  1. 입력 받기Scanner 사용하면 터질 것 같으니 버퍼로 입력 받는다.public static void main(String[] args) {    try(BufferedReader br = new BufferedReader(new InputStreamReader(System.in));        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out))) {                StringTokenizer st = new StringTokenizer(br.readLine(), &quot; &quot;);        int N = Integer.parseInt(st.nextToken());        int M = Integer.parseInt(st.nextToken());        int K = Integer.parseInt(st.nextToken());            }catch(IOException e) {        e.printStackTrace();    }}2. a번 문제a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값일단 M번 노드로 향하는 거니 M보다 작은 노드가 범인이다.어차피 모든 노드는 작은 수에서 큰 수로 이어지니 M번 노드보다 하나 작은, xor 연산에서 비트 하나 다른 놈을 찾아야한다.반복문으로 1인 비트를 반전시켜서 비교한다.// a번: 이진수 M의 1을 반전시킨 수 중 최대값// 최대값 저장용int a = Integer.MIN_VALUE;// 0번째 비트부터 올라감, 100,000,000는 27비트for (int i = 0 ; i &lt; 27 ; i++){    // M의 i번째 비트가 1인 경우    // == 1 할 경우 0번째 비트만 체크해서 오류 발생    //if ((M &amp; (1 &lt;&lt; i)) == 1) {    if ((M &amp; (1 &lt;&lt; i)) != 0) {        int m = M ^ (1 &lt;&lt; i); // 반전                if (m &lt; M &amp;&amp; m &gt; a) {            a = m;        }    }}3. b번 문제a번이랑 비슷한데, 각 비트를 반전시켜서 최소값을 찾으면 된다.// b번: M의 비트 하나를 반전시킨 수 중 M보다 큰 최소값 찾기// 최소값 저장용int b = Integer.MAX_VALUE;for (int i = 0 ; i &lt; 27 ; i++){    // i번째 비트를 반전시킨 숫자    int m = M ^ (1 &lt;&lt; i);    if (m &gt; M &amp;&amp; b &gt; m) {        b = m;    }}4. c번 문제해밍 무게 변화에 따른 경로 수를 구하는 것.전이 관계를 행렬 형태로 표현한 뒤, 행렬 거듭제곱을 통해 빠르게 K 단계를 계산한다.즉, 전체 시스템을 크기 N+1의 전이 행렬로 보고, dpK = T^K * dp₀ 형태로 계산하는 것이다!엄….좋아 완벽하게 이해했어!!일단 시간복잡도가 O(NK)면 절대 통과하지 못한다.O(N log K)로 바꾸면 통과가 가능하다.// c번: 공식계산doFactorials(N);// 초기 상태 dp0: 해밍 무게 w를 가진 노드 수 = C(N, w)int[] dp = new int[N + 1];for (int w = 0; w &lt;= N; w++) {    dp[w] = C(N, w);}// 전이 행렬 생성 (희소 형태로)List&lt;List&lt;Pair&gt;&gt; T = new ArrayList&lt;&gt;();for (int i = 0; i &lt;= N; i++) {    T.add(new ArrayList&lt;&gt;());}for (int w = 0; w &lt; N; w++) {    // 해밍 무게가 w인 노드에서 w+1로 갈 수 있는 경우만 존재    T.get(w + 1).add(new Pair(w, N - w));}// 희소 행렬 거듭제곱을 dp에 적용int[] dpK = sparseMatPowApply(T, dp, K, N + 1);// 모든 해밍 무게에서 끝나는 경로 수 합int c = 0;for (int w = 0; w &lt;= N; w++) {    c = (c + dpK[w]) % 100003;}// ... 중략 ...// 거듭제곱 계산public static int P(int b, int e) {    int r = 1;    while (e &gt; 0) {        if ((e &amp; 1) == 1) {            // 거듭제곱 계산            r = (int)((1L * r * b) % 100003);        }        b = (int)((1L * b * b) % 100003);        e &gt;&gt;= 1;    }    return r;}// 팩토리얼 및 역팩토리얼 계산 (페르마 소정리 활용)public static void doFactorials(int N) {    factorial = new int[N + 1];    invFactorial = new int[N + 1];    factorial[0] = 1;    for (int i = 1; i &lt;= N; i++) {        // 팩토리얼 계산        factorial[i] = (int)((1L * factorial[i - 1] * i) % 100003);    }    // 역팩토리얼 (페르마의 소정리)    invFactorial[N] = P(factorial[N], 100003 - 2);    for (int i = N - 1; i &gt;= 0; i--) {        // 역팩토리얼 누적 계산        invFactorial[i] = (int)((1L * invFactorial[i + 1] * (i + 1)) % 100003);    }}// 이항계수 계산public static int C(int N, int w) {    if (w &lt; 0 || w &gt; N) {        return 0;    }    // C(n, r) 계산    return (int)(1L * factorial[N] * invFactorial[w] % 100003 * invFactorial[N - w] % 100003);}// 희소행렬 형태: 각 행마다 (열, 값) 쌍 저장public static class Pair {    int col, val;    Pair(int col, int val) {        this.col = col;        this.val = val;    }}// 희소 행렬 곱셈public static int[] sparseMatVecMul(List&lt;List&lt;Pair&gt;&gt; mat, int[] vec, int size) {    int[] res = new int[size];    for (int i = 0; i &lt; size; i++) {        for (Pair p : mat.get(i)) {            res[i] = (int)((res[i] + 1L * p.val * vec[p.col]) % 100003);        }    }    return res;}// 희소 행렬 거듭제곱과 곱셈public static int[] sparseMatPowApply(List&lt;List&lt;Pair&gt;&gt; T, int[] vec, int exp, int size) {    // 초기 단위 행렬 적용: vec는 dp로 시작    while (exp &gt; 0) {        if ((exp &amp; 1) == 1) {            vec = sparseMatVecMul(T, vec, size);        }        // T = T * T (희소 곱)        List&lt;List&lt;Pair&gt;&gt; newT = new ArrayList&lt;&gt;();        for (int i = 0; i &lt; size; i++) {            newT.add(new ArrayList&lt;&gt;());        }        for (int i = 0; i &lt; size; i++) {            for (Pair kv1 : T.get(i)) {                for (Pair kv2 : T.get(kv1.col)) {                    int val = (int)((1L * kv1.val * kv2.val) % 100003);                    newT.get(i).add(new Pair(kv2.col, val));                }            }        }        // 중복 열 통합        for (int i = 0; i &lt; size; i++) {            if (newT.get(i).isEmpty()) continue;            List&lt;Pair&gt; row = newT.get(i);            row.sort(Comparator.comparingInt(p -&gt; p.col));            List&lt;Pair&gt; compressed = new ArrayList&lt;&gt;();            int lastCol = -1, sum = 0;            for (Pair p : row) {                if (p.col == lastCol) {                    sum = (sum + p.val) % 100003;                } else {                    if (lastCol != -1) compressed.add(new Pair(lastCol, sum));                    lastCol = p.col;                    sum = p.val;                }            }            if (lastCol != -1) compressed.add(new Pair(lastCol, sum));            newT.set(i, compressed);        }        T = newT;        exp &gt;&gt;= 1;    }    return vec;}  채점    반성  c번에서 계속 시간초과 나길래 C++로 돌려보고 로직 문제란걸 깨닫고 구글링했다.내 힘으로 풀 수 있는 문제가 아니었다.수학공부한 셈 쳐야지 뭐.  코드 확인  Link to GitHub">
      <meta itemprop="datePublished" content="2025-05-20T00:00:00+00:00">
      <meta itemprop="dateModified" content="2025-05-20T00:00:00+00:00">

      <div class="page__inner-wrap">
        
          <header>
            
<div class="post-category">
  <div class="category-path">
    <a href="/board?path=" class="category-link">Archive</a>
    
    
    
      <span class="separator">/</span>
      
      <a href="/board?path=random-solve" class="category-link">
        random-solve
      </a>
      
    
      <span class="separator">/</span>
      
      <a href="/board?path=random-solve%2FJava" class="category-link">
        Java
      </a>
      
    
  </div>
  <a href="/board?path=random-solve%2FJava%2F" class="category-icon" title="리스트">
    <i class="fas fa-list-ul" aria-hidden="true"></i>
  </a>
</div>
 
            <h1 id="page-title" class="page__title" itemprop="headline">15936번 Hypercube
</h1>
            


          </header>
        

        <section class="page__content" itemprop="text">
          <blockquote>
  <h4 id="문제">문제</h4>
  <hr />
</blockquote>

<p><img src="/assets/images/posts/random-solve/Java/2025-05-20-15936/img01.jpg" alt="img01" /></p>

<p><a href="https://www.acmicpc.net/problem/15936">15936번 Hypercube - 백준</a></p>

<blockquote>
  <h4 id="설계">설계</h4>
  <hr />
</blockquote>

<p>앗 영어문제<br />
아니 진짜 뭔 이딴문제만 걸리냐?</p>

<p>시간제한이 0.2초인데 이거 자바로 되나 싶었는데 푼 사람 목록보니 파이썬도 있다.<br />
알고리즘 잘 짜면 자바도 되겠지 뭐…</p>

<p>입력으로 N, M, K를 준다.</p>
<ul>
  <li>N: N차원 하이퍼 큐브</li>
  <li>M: 노드 번호</li>
  <li>K: 경로 길이</li>
</ul>

<p>하이퍼 큐브가 머에여???<br />
<a href="https://namu.wiki/w/%EC%B4%88%EC%9E%85%EB%B0%A9%EC%B2%B4">초입방체 - 나무위키</a></p>

<p>2^N개의 노드를 가지며 x에서 y로 가려면 x &lt; y 이고 xor 연산 시 2^p가 되어야 한다.(비트가 하나 다르다.)<br />
라고 문제에서 말해줌.</p>

<p>문제가 요구하는 건 3가지인데<br />
a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값<br />
b. M 번 노드에서 시작하는 간선이 향하는 노드 번호의 최소값<br />
c. 찾을 수 있는 K-길이의(K개의 간선을 포함하는) 경로의 개수. 100003 나머지 연산.</p>

<p>허허 이게 국어가 맞나</p>

<p>딱 봐도 하이퍼 큐브를 구현하면 제한 시간에 걸려 터진다.<br />
더 좋은 수학실력이 필요하다는 뜻임…</p>

<p>구글링으로 수학 고수들을 통해 문제 해결 공식을 얻은 다음 구현은 내가 하는 쪽으로 한다.<br />
나 혼자서는 풀 수 없음…</p>

<blockquote>
  <h4 id="구현">구현</h4>
  <hr />
</blockquote>

<h5 id="1-입력-받기">1. 입력 받기</h5>

<p>Scanner 사용하면 터질 것 같으니 버퍼로 입력 받는다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span><span class="o">(</span><span class="nc">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">));</span>
        <span class="nc">BufferedWriter</span> <span class="n">bw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedWriter</span><span class="o">(</span><span class="k">new</span> <span class="nc">OutputStreamWriter</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">)))</span> <span class="o">{</span>
        
        <span class="nc">StringTokenizer</span> <span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringTokenizer</span><span class="o">(</span><span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">(),</span> <span class="s">" "</span><span class="o">);</span>
        <span class="kt">int</span> <span class="no">N</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
        <span class="kt">int</span> <span class="no">M</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
        <span class="kt">int</span> <span class="no">K</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
        
    <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h5 id="2-a번-문제">2. a번 문제</h5>

<p>a. M 번 노드로 향하는 간선이 시작하는 노드 번호의 최댓값</p>

<p>일단 M번 노드로 향하는 거니 M보다 작은 노드가 범인이다.<br />
어차피 모든 노드는 작은 수에서 큰 수로 이어지니 M번 노드보다 하나 작은, xor 연산에서 비트 하나 다른 놈을 찾아야한다.<br />
반복문으로 1인 비트를 반전시켜서 비교한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// a번: 이진수 M의 1을 반전시킨 수 중 최대값</span>
<span class="c1">// 최대값 저장용</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">;</span>
<span class="c1">// 0번째 비트부터 올라감, 100,000,000는 27비트</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">27</span> <span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
    <span class="c1">// M의 i번째 비트가 1인 경우</span>
    <span class="c1">// == 1 할 경우 0번째 비트만 체크해서 오류 발생</span>
    <span class="c1">//if ((M &amp; (1 &lt;&lt; i)) == 1) {</span>
    <span class="k">if</span> <span class="o">((</span><span class="no">M</span> <span class="o">&amp;</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="o">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="no">M</span> <span class="o">^</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="o">);</span> <span class="c1">// 반전</span>
        
        <span class="k">if</span> <span class="o">(</span><span class="n">m</span> <span class="o">&lt;</span> <span class="no">M</span> <span class="o">&amp;&amp;</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h5 id="3-b번-문제">3. b번 문제</h5>

<p>a번이랑 비슷한데, 각 비트를 반전시켜서 최소값을 찾으면 된다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// b번: M의 비트 하나를 반전시킨 수 중 M보다 큰 최소값 찾기</span>
<span class="c1">// 최소값 저장용</span>
<span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">27</span> <span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
    <span class="c1">// i번째 비트를 반전시킨 숫자</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="no">M</span> <span class="o">^</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="no">M</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h5 id="4-c번-문제">4. c번 문제</h5>

<p>해밍 무게 변화에 따른 경로 수를 구하는 것.<br />
전이 관계를 행렬 형태로 표현한 뒤, 행렬 거듭제곱을 통해 빠르게 K 단계를 계산한다.<br />
즉, 전체 시스템을 크기 N+1의 전이 행렬로 보고, dpK = T^K * dp₀ 형태로 계산하는 것이다!</p>

<p>엄….</p>

<p><span style="color: orange;"><strong>좋아 완벽하게 이해했어!!</strong></span></p>

<p>일단 시간복잡도가 O(NK)면 절대 통과하지 못한다.<br />
O(N log K)로 바꾸면 통과가 가능하다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// c번: 공식계산</span>
<span class="n">doFactorials</span><span class="o">(</span><span class="no">N</span><span class="o">);</span>

<span class="c1">// 초기 상태 dp0: 해밍 무게 w를 가진 노드 수 = C(N, w)</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">dp</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">w</span> <span class="o">&lt;=</span> <span class="no">N</span><span class="o">;</span> <span class="n">w</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">dp</span><span class="o">[</span><span class="n">w</span><span class="o">]</span> <span class="o">=</span> <span class="no">C</span><span class="o">(</span><span class="no">N</span><span class="o">,</span> <span class="n">w</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// 전이 행렬 생성 (희소 형태로)</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;&gt;</span> <span class="no">T</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="no">T</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;());</span>
<span class="o">}</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="no">N</span><span class="o">;</span> <span class="n">w</span><span class="o">++)</span> <span class="o">{</span>
    <span class="c1">// 해밍 무게가 w인 노드에서 w+1로 갈 수 있는 경우만 존재</span>
    <span class="no">T</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pair</span><span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="no">N</span> <span class="o">-</span> <span class="n">w</span><span class="o">));</span>
<span class="o">}</span>

<span class="c1">// 희소 행렬 거듭제곱을 dp에 적용</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">dpK</span> <span class="o">=</span> <span class="n">sparseMatPowApply</span><span class="o">(</span><span class="no">T</span><span class="o">,</span> <span class="n">dp</span><span class="o">,</span> <span class="no">K</span><span class="o">,</span> <span class="no">N</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>

<span class="c1">// 모든 해밍 무게에서 끝나는 경로 수 합</span>
<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">w</span> <span class="o">&lt;=</span> <span class="no">N</span><span class="o">;</span> <span class="n">w</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">dpK</span><span class="o">[</span><span class="n">w</span><span class="o">])</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ... 중략 ...</span>

<span class="c1">// 거듭제곱 계산</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">P</span><span class="o">(</span><span class="kt">int</span> <span class="n">b</span><span class="o">,</span> <span class="kt">int</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">e</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// 거듭제곱 계산</span>
            <span class="n">r</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 팩토리얼 및 역팩토리얼 계산 (페르마 소정리 활용)</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doFactorials</span><span class="o">(</span><span class="kt">int</span> <span class="no">N</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">factorial</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
    <span class="n">invFactorial</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span> <span class="o">+</span> <span class="mi">1</span><span class="o">];</span>
    <span class="n">factorial</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="c1">// 팩토리얼 계산</span>
        <span class="n">factorial</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">factorial</span><span class="o">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span> <span class="o">*</span> <span class="n">i</span><span class="o">)</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 역팩토리얼 (페르마의 소정리)</span>
    <span class="n">invFactorial</span><span class="o">[</span><span class="no">N</span><span class="o">]</span> <span class="o">=</span> <span class="no">P</span><span class="o">(</span><span class="n">factorial</span><span class="o">[</span><span class="no">N</span><span class="o">],</span> <span class="mi">100003</span> <span class="o">-</span> <span class="mi">2</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="no">N</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>
        <span class="c1">// 역팩토리얼 누적 계산</span>
        <span class="n">invFactorial</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">invFactorial</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">*</span> <span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// 이항계수 계산</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">C</span><span class="o">(</span><span class="kt">int</span> <span class="no">N</span><span class="o">,</span> <span class="kt">int</span> <span class="n">w</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">w</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="no">N</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// C(n, r) 계산</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)(</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">factorial</span><span class="o">[</span><span class="no">N</span><span class="o">]</span> <span class="o">*</span> <span class="n">invFactorial</span><span class="o">[</span><span class="n">w</span><span class="o">]</span> <span class="o">%</span> <span class="mi">100003</span> <span class="o">*</span> <span class="n">invFactorial</span><span class="o">[</span><span class="no">N</span> <span class="o">-</span> <span class="n">w</span><span class="o">]</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// 희소행렬 형태: 각 행마다 (열, 값) 쌍 저장</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Pair</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">col</span><span class="o">,</span> <span class="n">val</span><span class="o">;</span>
    <span class="nc">Pair</span><span class="o">(</span><span class="kt">int</span> <span class="n">col</span><span class="o">,</span> <span class="kt">int</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">col</span> <span class="o">=</span> <span class="n">col</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// 희소 행렬 곱셈</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">sparseMatVecMul</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;&gt;</span> <span class="n">mat</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">vec</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span><span class="o">[]</span> <span class="n">res</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Pair</span> <span class="n">p</span> <span class="o">:</span> <span class="n">mat</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">res</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="n">res</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1L</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="na">val</span> <span class="o">*</span> <span class="n">vec</span><span class="o">[</span><span class="n">p</span><span class="o">.</span><span class="na">col</span><span class="o">])</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 희소 행렬 거듭제곱과 곱셈</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">sparseMatPowApply</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;&gt;</span> <span class="no">T</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">vec</span><span class="o">,</span> <span class="kt">int</span> <span class="n">exp</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 초기 단위 행렬 적용: vec는 dp로 시작</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">exp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">exp</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">sparseMatVecMul</span><span class="o">(</span><span class="no">T</span><span class="o">,</span> <span class="n">vec</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// T = T * T (희소 곱)</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;&gt;</span> <span class="n">newT</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">newT</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;());</span>
        <span class="o">}</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Pair</span> <span class="n">kv1</span> <span class="o">:</span> <span class="no">T</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="nc">Pair</span> <span class="n">kv2</span> <span class="o">:</span> <span class="no">T</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">kv1</span><span class="o">.</span><span class="na">col</span><span class="o">))</span> <span class="o">{</span>
                    <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)((</span><span class="mi">1L</span> <span class="o">*</span> <span class="n">kv1</span><span class="o">.</span><span class="na">val</span> <span class="o">*</span> <span class="n">kv2</span><span class="o">.</span><span class="na">val</span><span class="o">)</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">);</span>
                    <span class="n">newT</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pair</span><span class="o">(</span><span class="n">kv2</span><span class="o">.</span><span class="na">col</span><span class="o">,</span> <span class="n">val</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// 중복 열 통합</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">newT</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">isEmpty</span><span class="o">())</span> <span class="k">continue</span><span class="o">;</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;</span> <span class="n">row</span> <span class="o">=</span> <span class="n">newT</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">row</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="nc">Comparator</span><span class="o">.</span><span class="na">comparingInt</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="n">p</span><span class="o">.</span><span class="na">col</span><span class="o">));</span>

            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pair</span><span class="o">&gt;</span> <span class="n">compressed</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="kt">int</span> <span class="n">lastCol</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Pair</span> <span class="n">p</span> <span class="o">:</span> <span class="n">row</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">col</span> <span class="o">==</span> <span class="n">lastCol</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">sum</span> <span class="o">=</span> <span class="o">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="na">val</span><span class="o">)</span> <span class="o">%</span> <span class="mi">100003</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">lastCol</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="n">compressed</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pair</span><span class="o">(</span><span class="n">lastCol</span><span class="o">,</span> <span class="n">sum</span><span class="o">));</span>
                    <span class="n">lastCol</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">col</span><span class="o">;</span>
                    <span class="n">sum</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">val</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">lastCol</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="n">compressed</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pair</span><span class="o">(</span><span class="n">lastCol</span><span class="o">,</span> <span class="n">sum</span><span class="o">));</span>
            <span class="n">newT</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">compressed</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="no">T</span> <span class="o">=</span> <span class="n">newT</span><span class="o">;</span>
        <span class="n">exp</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">vec</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <h4 id="채점">채점</h4>
  <hr />
</blockquote>

<p><img src="/assets/images/posts/random-solve/Java/2025-05-20-15936/img02.jpg" alt="img02" /></p>

<blockquote>
  <h4 id="반성">반성</h4>
  <hr />
</blockquote>

<p>c번에서 계속 시간초과 나길래 C++로 돌려보고 로직 문제란걸 깨닫고 구글링했다.<br />
내 힘으로 풀 수 있는 문제가 아니었다.<br />
수학공부한 셈 쳐야지 뭐.</p>

<blockquote>
  <h4 id="코드-확인">코드 확인</h4>
  <hr />
</blockquote>

<p><a href="https://raw.githubusercontent.com/movingwoo/movingwoo-snippets/refs/heads/main/random-solve/Java/2025-05-20-15936.java">Link to GitHub</a></p>


          
        </section>

        <footer class="page__meta">
          
          

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-05-20">May 20, 2025</time></p>


        </footer>

        

        
<nav class="post-navigation">
  <div id="postNavigation" class="post-navigation__container"></div>

  <script>
    // 별도 js로 post data 넘겨주기만
    window.postData = {
      currentPost: {
        title: "15936번 Hypercube",
        url: "/random-solve/java/2025/05/20/15936.html",
        date: "2025-05-20",
        categories: ["random-solve/Java/"]
      },
      allPosts: [
        
        
          
          
          {
            title: "5101번 Sequences",
            url: "/random-solve/python/2025/05/23/5101.html",
            date: "2025-05-23",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "27391번 Platform Placing",
            url: "/random-solve/java/2025/05/23/27391.html",
            date: "2025-05-23",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "25245번 Amusement Arcade",
            url: "/random-solve/c++/2025/05/23/25245.html",
            date: "2025-05-23",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "미로 생성기 03",
            url: "/one-pan/javascript/2025/05/23/Maze-Generator-03.html",
            date: "2025-05-23",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "26489번 Gum Gum for Jay Jay",
            url: "/random-solve/python/2025/05/22/26489.html",
            date: "2025-05-22",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "미로 생성기 02",
            url: "/one-pan/javascript/2025/05/21/Maze-Generator-02.html",
            date: "2025-05-21",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "26226번 Autocomplete",
            url: "/random-solve/c++/2025/05/21/26226.html",
            date: "2025-05-21",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "미로 생성기 01",
            url: "/one-pan/javascript/2025/05/20/Maze-Generator-01.html",
            date: "2025-05-20",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "15936번 Hypercube",
            url: "/random-solve/java/2025/05/20/15936.html",
            date: "2025-05-20",
            categories: ["random-solve/Java/"]
          },
          
        
          
          
          {
            title: "29348번 Скользкий путь",
            url: "/random-solve/c++/2025/05/16/29348.html",
            date: "2025-05-16",
            categories: ["random-solve/C++/"]
          },
          
        
          
          
          {
            title: "18382번 2048",
            url: "/random-solve/python/2025/05/15/18382.html",
            date: "2025-05-15",
            categories: ["random-solve/Python/"]
          },
          
        
          
          
          {
            title: "랜덤 출력기",
            url: "/one-pan/javascript/2025/05/14/Random-Printer.html",
            date: "2025-05-14",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "파이썬으로 CLI TODO 리스트 만들어보기",
            url: "/ai-playground/gpt/2025/05/14/GPT.html",
            date: "2025-05-14",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "플래피 버드",
            url: "/one-pan/javascript/2025/05/13/Flappy-Bird.html",
            date: "2025-05-13",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "클리커",
            url: "/one-pan/python/2025/05/13/Clicker.html",
            date: "2025-05-13",
            categories: ["one-pan/Python/"]
          },
          
        
          
          
          {
            title: "파일 복사기",
            url: "/one-pan/shellscript/2025/05/12/File-Copier.html",
            date: "2025-05-12",
            categories: ["one-pan/ShellScript/"]
          },
          
        
          
          
          {
            title: "숫자야구",
            url: "/one-pan/java/2025/05/11/Bulls-and-Cows.html",
            date: "2025-05-11",
            categories: ["one-pan/Java/"]
          },
          
        
          
          
          {
            title: "즐거운 연휴",
            url: "/ai-playground/gpt/2025/05/01/GPT.html",
            date: "2025-05-01",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "즐거운 연휴, 어떻게 보내면 좋을까?",
            url: "/ai-playground/claude/2025/05/01/Claude.html",
            date: "2025-05-01",
            categories: ["AI-playground/Claude/"]
          },
          
        
          
          
          {
            title: "프로그래머를 위한 생산성 툴 TOP 5 🧰",
            url: "/ai-playground/gpt/2025/04/30/GPT.html",
            date: "2025-04-30",
            categories: ["AI-playground/GPT/"]
          },
          
        
          
          
          {
            title: "AI 시대의 개발자, 어떻게 준비해야 할까?",
            url: "/ai-playground/claude/2025/04/30/Claude.html",
            date: "2025-04-30",
            categories: ["AI-playground/Claude/"]
          },
          
        
          
          
          {
            title: "지뢰찾기",
            url: "/one-pan/javascript/2025/04/29/Minesweeper.html",
            date: "2025-04-29",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "서버 관리 콘솔",
            url: "/one-pan/shellscript/2025/04/28/Server-Manage-Console.html",
            date: "2025-04-28",
            categories: ["one-pan/ShellScript/"]
          }
          
        
      ]
    };
  </script>
  <script src="/assets/js/post_pagination.js" defer></script>
</nav>

      </div>

      
      
      
        <script src="https://giscus.app/client.js"
        data-repo="movingwoo/movingwoo.github.io"
        data-repo-id="R_kgDOORY1lQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOORY1lc4CpoFq"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="https://movingwoo.com/assets/css/giscus-theme.css"
        data-lang="ko"
        crossorigin="anonymous"
        async>
</script>
      
    </article>

    
    
  </div>
</div>

<style>
.home-layout {
  display: flex;
  max-width: 1500px;
  margin: 0 auto;
  padding: 0;
}

.home-sidebar {
  flex-shrink: 0;
  width: 300px;
  margin-right: 1rem;
  position: relative;
  display: block !important;
}

.home-content {
  flex-grow: 1;
  min-width: 0;
  width: 100%;
}

@media (max-width: 64em) {
  .home-layout {
    flex-direction: column;
  }
  
  .home-sidebar {
    width: 100%;
    margin-right: 0;
    margin-bottom: 1rem;
  }
  
  .home-content {
    padding: 0;
  }
}
</style>

    </div>

    
    
    <div class="page__footer">
  <div class="page__footer-copyright">
    Visit: <a href="https://github.com/movingwoo/movingwoo.github.io">https://github.com/movingwoo/movingwoo.github.io</a>
    <br>
    <span class="theme-credit">Theme customized from Minimal Mistakes by Michael Rose (MIT License).</span>
  </div>
</div>

    <div class="scroll-button">
  <div class="scroll-button__container">
    <button class="scroll-button__area scroll-button__area--top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="위로">
      <i class="fas fa-arrow-up"></i>
    </button>
    <button class="scroll-button__area scroll-button__area--bottom" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})" title="아래로">
      <i class="fas fa-arrow-down"></i>
    </button>
  </div>
</div>

<style>
.scroll-button {
  position: fixed;
  right: 20px;
  bottom: 20px;
  z-index: 1000;
}

.scroll-button__container {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid rgba(220, 20, 60, 0.6);
  background-color: transparent;
  position: relative;
  overflow: hidden;
}

.scroll-button__area {
  position: absolute;
  width: 100%;
  height: 50%;
  left: 0;
  background: transparent;
  border: none;
  color: rgba(220, 20, 60, 0.6);
  cursor: pointer;
  padding: 0;
  transition: all 0.3s ease;
  outline: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scroll-button__area--top {
  top: 0;
}

.scroll-button__area--bottom {
  bottom: 0;
}

.scroll-button__area:focus {
  outline: none;
}

.scroll-button__area:hover {
  color: rgba(220, 20, 60, 1);
}

.scroll-button__area:hover i {
  transform: scale(1.2);
}

.scroll-button__area i {
  font-size: 1rem;
  transition: transform 0.3s ease;
}

@media (max-width: 768px) {
  .scroll-button {
    right: 10px;
    bottom: 10px;
  }
  
  .scroll-button__container {
    width: 50px;
    height: 50px;
  }
}
</style> 
    
  <script src="/assets/js/main.min.js"></script>









<script>
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});
document.addEventListener('copy', function(e) {
    e.preventDefault();
});
</script>


  </body>
</html>
