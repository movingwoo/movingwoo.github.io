<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>지뢰찾기 - The Archive</title>
<meta name="description" content="탄생 비화      바닐라 JS 재활훈련삼아 투닥투닥 두들겨 봄 재활훈련을 마치면 canvas를 이용해 뭐라도 만들어 볼 요량     구현 포인트      1. 지뢰판 뿌리기  처음에는 그리드로 대충 만들어 뿌렸는데 뿌려놓고 css가 변경될 경우 리드로우가 일어난다고 한다. 그래서 DOM을 직접 컨트롤하는건 권장하지 않는다고 지뢰찾기 몇 칸 넣는데 영향은 없겠지만 연습삼아 fragment를 사용해본다.  그리고 옛날사람처럼 굴지말고 템플릿 리터럴을 활용하면 더 깔끔해진다.  // 스타일 설정 mainArea.style.width = &#39;800px&#39;; mainArea.style.display = &#39;grid&#39;; // 템플릿 리터럴을 사용하지 않으면 보기 지저분하게 + 해가며 써야함 // mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + col + &#39;, 1fr)&#39;; // mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + row + &#39;, 1fr)&#39;; mainArea.style.gridTemplateColumns = `repeat(${col}, 1fr)`; mainArea.style.gridTemplateRows = `repeat(${row}, 1fr)`; mainArea.style.gap = &#39;1px&#39;;  			 // fragment 생성 const divFragment = document.createDocumentFragment();  for (let i = 0; i &lt; col * row; i++) {   const newDiv = document.createElement(&#39;div&#39;);   const currentRow = Math.floor(i / col) + 1;   const currentCol = (i % col) + 1;      // 각 div에는 col과 row로 이루어진 고유 값을 id로 설정한다.   // col과 row로 고유 id 설정   newDiv.id = `${currentRow} ${currentCol}`;      // 스타일 설정   newDiv.style.aspectRatio = &#39;1 / 1&#39;;   newDiv.style.border = &#39;1px solid black&#39;;   newDiv.style.padding = &#39;1px&#39;;   newDiv.style.display = &#39;flex&#39;;   newDiv.style.alignItems = &#39;center&#39;;   newDiv.style.justifyContent = &#39;center&#39;;   newDiv.style.background = &#39;gray&#39;    // fragment에 추가   divFragment.appendChild(newDiv); }  // DOM에 추가 mainArea.appendChild(divFragment);   2. 클릭 감지  좌클릭 우클릭은 간단하지만 지뢰찾기는 동시클릭 시 주변에 지뢰가 있을 가능성이 있는 타일을 표시해준다. 따라서 동시클릭을 인식하도록 해야한다. 마우스 좌우를 한 치 오차없이 누르는 건 불가능하기 때문에, 유예시간을 짧게 두고 양쪽이 모두 클릭되어있으면 동시 클릭으로 취급해야한다.  /** 마우스 다운 이벤트 */ function MouseDownHandler(event) {    if (!startTime) startTime = new Date(); // 첫 클릭 시간 체크    // 클릭한 타겟의 id와 value 획득   const targetId = event.target.id;   const targetValue = event.target.dataset.value;   if (!targetId || !targetValue) return;    // 0은 좌클릭, 2는 우클릭   if (event.button === 0) leftDown = true;   else if (event.button === 2) rightDown = true;    if (clickDelay) clearTimeout(clickDelay); // 이전 timeout이 있으면 취소    clickDelay = setTimeout(() =&gt; {     // 변수 불값으로 판단     if (leftDown &amp;&amp; rightDown) check(event.target);     else if (leftDown) open(event.target);     else if (rightDown) flag(event.target);          // 초기화     clickDelay = null;   }, 50); // 딜레이 50ms }   3. 지뢰 설정  고유의 id를 가지고 있는 판을 만들었으니 지뢰를 배치해야 한다. 지뢰 주변에는 숫자가 표기되어야 하는데, 구조 상 숫자는 0에서 8까지만 쓸 수 있다. 따라서 지뢰를 9로 배치하고 나머지 칸엔 주변 지뢰상황을 파악해 숫자를 매긴다.  // set을 이용해 무작위 칸에 value 9를 세팅한다. const divs = document.querySelectorAll(&#39;#main_area div&#39;); const mineSet = new Set(); // 중복 방지용 set  while (mineSet.size &lt; mines) {   // 무작위 인덱스 값 생성   const randomIdx = Math.floor(Math.random() * col * row);      if (!mineSet.has(randomIdx)) {     // set에 집어넣으며 지뢰 세팅     mineSet.add(randomIdx);     divs[randomIdx].dataset.value = 9;   } }  // 전체 div를 탐색하며 9가 아닌 경우 주변 칸이 9인 개수를 세팅한다. divs.forEach(div =&gt; {   if (div.dataset.value == 9) return;    // 유효한 인접 div 가져오기   const validNeighbors = findNeighbors(div.id);    // 유효 범위 내 지뢰 개수 카운팅   let mineCount = 0;   validNeighbors.forEach(([r, c]) =&gt; {       const neighborDiv = document.getElementById(`${r} ${c}`);       if (neighborDiv &amp;&amp; neighborDiv.dataset.value == 9) {           mineCount++;       }   });    div.dataset.value = mineCount; });   지뢰 제외 숫자를 세팅하기위해 특정 div의 주변 div를 탐색하는 함수를 별도로 만들어준다. 좌클릭으로 칸을 열때, 자동으로 열릴때, 동시클릭 시 등 쓰일 곳이 많은 공통함수이다.  /** 인접 div 탐색 */ function findNeighbors(divId) {    // id를 파싱해 현재 좌표 확인   const[currentRow, currentCol] = divId.split(&#39; &#39;).map(Number);    // 인접한 전체 좌표 확인   const neighbors = [       [currentRow - 1, currentCol - 1], [currentRow - 1, currentCol], [currentRow - 1, currentCol + 1],       [currentRow    , currentCol - 1],         /* 현재 칸 */          [currentRow    , currentCol + 1],       [currentRow + 1, currentCol - 1], [currentRow + 1, currentCol], [currentRow + 1, currentCol + 1]   ];    // 행열 범위를 벗어나면 제외하고 return   return neighbors.filter(([r, c]) =&gt; r &gt;= 1 &amp;&amp; r &lt;= row &amp;&amp; c &gt;= 1 &amp;&amp; c &lt;= col); }   4. 지뢰찾기 기능 부여  좌클릭, 우클릭, 동시클릭 이벤트에 실제 게임 로직을 부여한다.    좌클릭            지뢰(9)인 경우 게임 오버       지뢰가 아닌 경우                    0인 경우 인접칸을 자동으로 열기           0이 아닌 경우 해당 칸만 열기                           우클릭            지뢰표시(flag)       표시된 칸에 다시 우클릭 시 표시 제거           동시클릭            인접 칸 하이라이팅       만약 인접 칸 모든 곳에 지뢰가 없는 것이 확실한 경우 자동으로 열기           // 닫힌칸은 회색, 열린칸은 흰색, 플래그는 검정색, 하이라이팅은 파란색, 게임오버 시 지뢰 위치는 빨간색  /** 좌클릭 시 open */ function open(targetDiv) {    // 지뢰칸은 즉시 패배처리   if (targetDiv.dataset.value == 9) {     youLose();     return;   }      targetDiv.style.background = &#39;white&#39;;      // 0인 경우엔 주변 div를 자동으로 열어줌   if (targetDiv.dataset.value == 0) {     findNeighbors(targetDiv.id).forEach(([r, c]) =&gt; {       const div = document.getElementById(`${r} ${c}`);              // 재귀 중 꼬이지 않게 열리지 않은 div만 열기       if (div.style.background == &#39;gray&#39;) open(div);     });   } else {     targetDiv.textContent = targetDiv.dataset.value;   }    }  /** 우클릭 시 flag */ function flag(targetDiv) {    const remainDiv = document.querySelector(&#39;#remain&#39;);    // 닫혀있는 div에 플래그를 추가하며, 플래그가 추가된 칸일 경우 플래그 해제   if (targetDiv.style.background == &#39;gray&#39;) {     targetDiv.style.background =&#39;black&#39;;     remainDiv.dataset.value = remainDiv.dataset.value - 1;   } else if (targetDiv.style.background == &#39;black&#39;) {     targetDiv.style.background =&#39;gray&#39;;     remainDiv.dataset.value = remainDiv.dataset.value - 1 + 2;   }    }  /** 동시클릭 시 check */ function check(targetDiv) {    const neighbors = findNeighbors(targetDiv.id);      // 플래그 수   let flagCount = 0;      neighbors.forEach(([r, c]) =&gt; {     if (document.getElementById(`${r} ${c}`).style.background == &#39;black&#39;) flagCount++;   });      // 플래그와 지뢰수가 같으면 open, 아니면 주변 칸 반짝   // 플래그 잘못 표시하여 자동오픈으로 지뢰 터지는것도 가능함   neighbors.forEach(([r, c]) =&gt; {     const div = document.getElementById(`${r} ${c}`);     if (div.style.background == &#39;gray&#39;) {       if (flagCount == targetDiv.dataset.value) open(div);       else div.style.background = &#39;blue&#39;     }   }); }   5. 승리 및 패배 판정  승리 판정은 매 좌클릭 후 체크한다. 플래그 체크 안하고 클리어할 수 있으므로 판정은 닫혀있는 div 개수가 총 지뢰수와 같으면 승리한 것으로 한다.  /** 승리 반별 */ function checkWin() {   // 닫혀있는 div 개수 세기   let closeCount = 0;      document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {     if (div.style.background != &#39;white&#39;) closeCount++;   });      // 총 지뢰 수와 닫혀있는 div 수가 같으면 승리   if (closeCount === mines) {     youWin();     return;   } }  /** 승리 처리 */ function youWin() {    const endTime = new Date(); // 종료시간   const elapsedTime = Math.floor((endTime - startTime) / 1000); // 경과 시간 초 단위      // 승자에 대한 찬사   alert(`You Win!!\n${Math.floor(elapsedTime / 60)}분 ${elapsedTime % 60}초`);      // 마우스 이벤트 제거   document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);   document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler); }  /** 패배 처리 */ function youLose() {    // 패배자에 대한 조롱   alert(&#39;You Lose!!&#39;);      // 모든 보드 열기   document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {     if (div.dataset.value == 9) {       // 지뢰 위치는 빨간색으로 표시       div.style.background = &#39;red&#39;;     } else {       div.style.background = &#39;white&#39;;       div.textContent = div.dataset.value;     }   });      // 마우스 이벤트 제거   document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);   document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler); }      완성         직접 해보기     이지선다 지옥…    크아아아아아아아악     반성              DOM 직접 컨트롤 피하기 이유는 상술           디자인 및 접근성 뭔가 더 예쁘고 접근성 좋게 처리할 수 있었을 거란 아쉬움이 남는다 div 사이 빈 줄도 없앨 수 있었을텐데… AI도 잘 되어있는 세상인데…         코드 확인      Link to GitHub">



<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="The Archive">
<meta property="og:title" content="지뢰찾기">
<meta property="og:url" content="https://movingwoo.github.io/one-pan/javascript/2025/04/29/Minesweeper.html">


  <meta property="og:description" content="탄생 비화      바닐라 JS 재활훈련삼아 투닥투닥 두들겨 봄 재활훈련을 마치면 canvas를 이용해 뭐라도 만들어 볼 요량     구현 포인트      1. 지뢰판 뿌리기  처음에는 그리드로 대충 만들어 뿌렸는데 뿌려놓고 css가 변경될 경우 리드로우가 일어난다고 한다. 그래서 DOM을 직접 컨트롤하는건 권장하지 않는다고 지뢰찾기 몇 칸 넣는데 영향은 없겠지만 연습삼아 fragment를 사용해본다.  그리고 옛날사람처럼 굴지말고 템플릿 리터럴을 활용하면 더 깔끔해진다.  // 스타일 설정 mainArea.style.width = &#39;800px&#39;; mainArea.style.display = &#39;grid&#39;; // 템플릿 리터럴을 사용하지 않으면 보기 지저분하게 + 해가며 써야함 // mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + col + &#39;, 1fr)&#39;; // mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + row + &#39;, 1fr)&#39;; mainArea.style.gridTemplateColumns = `repeat(${col}, 1fr)`; mainArea.style.gridTemplateRows = `repeat(${row}, 1fr)`; mainArea.style.gap = &#39;1px&#39;;  			 // fragment 생성 const divFragment = document.createDocumentFragment();  for (let i = 0; i &lt; col * row; i++) {   const newDiv = document.createElement(&#39;div&#39;);   const currentRow = Math.floor(i / col) + 1;   const currentCol = (i % col) + 1;      // 각 div에는 col과 row로 이루어진 고유 값을 id로 설정한다.   // col과 row로 고유 id 설정   newDiv.id = `${currentRow} ${currentCol}`;      // 스타일 설정   newDiv.style.aspectRatio = &#39;1 / 1&#39;;   newDiv.style.border = &#39;1px solid black&#39;;   newDiv.style.padding = &#39;1px&#39;;   newDiv.style.display = &#39;flex&#39;;   newDiv.style.alignItems = &#39;center&#39;;   newDiv.style.justifyContent = &#39;center&#39;;   newDiv.style.background = &#39;gray&#39;    // fragment에 추가   divFragment.appendChild(newDiv); }  // DOM에 추가 mainArea.appendChild(divFragment);   2. 클릭 감지  좌클릭 우클릭은 간단하지만 지뢰찾기는 동시클릭 시 주변에 지뢰가 있을 가능성이 있는 타일을 표시해준다. 따라서 동시클릭을 인식하도록 해야한다. 마우스 좌우를 한 치 오차없이 누르는 건 불가능하기 때문에, 유예시간을 짧게 두고 양쪽이 모두 클릭되어있으면 동시 클릭으로 취급해야한다.  /** 마우스 다운 이벤트 */ function MouseDownHandler(event) {    if (!startTime) startTime = new Date(); // 첫 클릭 시간 체크    // 클릭한 타겟의 id와 value 획득   const targetId = event.target.id;   const targetValue = event.target.dataset.value;   if (!targetId || !targetValue) return;    // 0은 좌클릭, 2는 우클릭   if (event.button === 0) leftDown = true;   else if (event.button === 2) rightDown = true;    if (clickDelay) clearTimeout(clickDelay); // 이전 timeout이 있으면 취소    clickDelay = setTimeout(() =&gt; {     // 변수 불값으로 판단     if (leftDown &amp;&amp; rightDown) check(event.target);     else if (leftDown) open(event.target);     else if (rightDown) flag(event.target);          // 초기화     clickDelay = null;   }, 50); // 딜레이 50ms }   3. 지뢰 설정  고유의 id를 가지고 있는 판을 만들었으니 지뢰를 배치해야 한다. 지뢰 주변에는 숫자가 표기되어야 하는데, 구조 상 숫자는 0에서 8까지만 쓸 수 있다. 따라서 지뢰를 9로 배치하고 나머지 칸엔 주변 지뢰상황을 파악해 숫자를 매긴다.  // set을 이용해 무작위 칸에 value 9를 세팅한다. const divs = document.querySelectorAll(&#39;#main_area div&#39;); const mineSet = new Set(); // 중복 방지용 set  while (mineSet.size &lt; mines) {   // 무작위 인덱스 값 생성   const randomIdx = Math.floor(Math.random() * col * row);      if (!mineSet.has(randomIdx)) {     // set에 집어넣으며 지뢰 세팅     mineSet.add(randomIdx);     divs[randomIdx].dataset.value = 9;   } }  // 전체 div를 탐색하며 9가 아닌 경우 주변 칸이 9인 개수를 세팅한다. divs.forEach(div =&gt; {   if (div.dataset.value == 9) return;    // 유효한 인접 div 가져오기   const validNeighbors = findNeighbors(div.id);    // 유효 범위 내 지뢰 개수 카운팅   let mineCount = 0;   validNeighbors.forEach(([r, c]) =&gt; {       const neighborDiv = document.getElementById(`${r} ${c}`);       if (neighborDiv &amp;&amp; neighborDiv.dataset.value == 9) {           mineCount++;       }   });    div.dataset.value = mineCount; });   지뢰 제외 숫자를 세팅하기위해 특정 div의 주변 div를 탐색하는 함수를 별도로 만들어준다. 좌클릭으로 칸을 열때, 자동으로 열릴때, 동시클릭 시 등 쓰일 곳이 많은 공통함수이다.  /** 인접 div 탐색 */ function findNeighbors(divId) {    // id를 파싱해 현재 좌표 확인   const[currentRow, currentCol] = divId.split(&#39; &#39;).map(Number);    // 인접한 전체 좌표 확인   const neighbors = [       [currentRow - 1, currentCol - 1], [currentRow - 1, currentCol], [currentRow - 1, currentCol + 1],       [currentRow    , currentCol - 1],         /* 현재 칸 */          [currentRow    , currentCol + 1],       [currentRow + 1, currentCol - 1], [currentRow + 1, currentCol], [currentRow + 1, currentCol + 1]   ];    // 행열 범위를 벗어나면 제외하고 return   return neighbors.filter(([r, c]) =&gt; r &gt;= 1 &amp;&amp; r &lt;= row &amp;&amp; c &gt;= 1 &amp;&amp; c &lt;= col); }   4. 지뢰찾기 기능 부여  좌클릭, 우클릭, 동시클릭 이벤트에 실제 게임 로직을 부여한다.    좌클릭            지뢰(9)인 경우 게임 오버       지뢰가 아닌 경우                    0인 경우 인접칸을 자동으로 열기           0이 아닌 경우 해당 칸만 열기                           우클릭            지뢰표시(flag)       표시된 칸에 다시 우클릭 시 표시 제거           동시클릭            인접 칸 하이라이팅       만약 인접 칸 모든 곳에 지뢰가 없는 것이 확실한 경우 자동으로 열기           // 닫힌칸은 회색, 열린칸은 흰색, 플래그는 검정색, 하이라이팅은 파란색, 게임오버 시 지뢰 위치는 빨간색  /** 좌클릭 시 open */ function open(targetDiv) {    // 지뢰칸은 즉시 패배처리   if (targetDiv.dataset.value == 9) {     youLose();     return;   }      targetDiv.style.background = &#39;white&#39;;      // 0인 경우엔 주변 div를 자동으로 열어줌   if (targetDiv.dataset.value == 0) {     findNeighbors(targetDiv.id).forEach(([r, c]) =&gt; {       const div = document.getElementById(`${r} ${c}`);              // 재귀 중 꼬이지 않게 열리지 않은 div만 열기       if (div.style.background == &#39;gray&#39;) open(div);     });   } else {     targetDiv.textContent = targetDiv.dataset.value;   }    }  /** 우클릭 시 flag */ function flag(targetDiv) {    const remainDiv = document.querySelector(&#39;#remain&#39;);    // 닫혀있는 div에 플래그를 추가하며, 플래그가 추가된 칸일 경우 플래그 해제   if (targetDiv.style.background == &#39;gray&#39;) {     targetDiv.style.background =&#39;black&#39;;     remainDiv.dataset.value = remainDiv.dataset.value - 1;   } else if (targetDiv.style.background == &#39;black&#39;) {     targetDiv.style.background =&#39;gray&#39;;     remainDiv.dataset.value = remainDiv.dataset.value - 1 + 2;   }    }  /** 동시클릭 시 check */ function check(targetDiv) {    const neighbors = findNeighbors(targetDiv.id);      // 플래그 수   let flagCount = 0;      neighbors.forEach(([r, c]) =&gt; {     if (document.getElementById(`${r} ${c}`).style.background == &#39;black&#39;) flagCount++;   });      // 플래그와 지뢰수가 같으면 open, 아니면 주변 칸 반짝   // 플래그 잘못 표시하여 자동오픈으로 지뢰 터지는것도 가능함   neighbors.forEach(([r, c]) =&gt; {     const div = document.getElementById(`${r} ${c}`);     if (div.style.background == &#39;gray&#39;) {       if (flagCount == targetDiv.dataset.value) open(div);       else div.style.background = &#39;blue&#39;     }   }); }   5. 승리 및 패배 판정  승리 판정은 매 좌클릭 후 체크한다. 플래그 체크 안하고 클리어할 수 있으므로 판정은 닫혀있는 div 개수가 총 지뢰수와 같으면 승리한 것으로 한다.  /** 승리 반별 */ function checkWin() {   // 닫혀있는 div 개수 세기   let closeCount = 0;      document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {     if (div.style.background != &#39;white&#39;) closeCount++;   });      // 총 지뢰 수와 닫혀있는 div 수가 같으면 승리   if (closeCount === mines) {     youWin();     return;   } }  /** 승리 처리 */ function youWin() {    const endTime = new Date(); // 종료시간   const elapsedTime = Math.floor((endTime - startTime) / 1000); // 경과 시간 초 단위      // 승자에 대한 찬사   alert(`You Win!!\n${Math.floor(elapsedTime / 60)}분 ${elapsedTime % 60}초`);      // 마우스 이벤트 제거   document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);   document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler); }  /** 패배 처리 */ function youLose() {    // 패배자에 대한 조롱   alert(&#39;You Lose!!&#39;);      // 모든 보드 열기   document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {     if (div.dataset.value == 9) {       // 지뢰 위치는 빨간색으로 표시       div.style.background = &#39;red&#39;;     } else {       div.style.background = &#39;white&#39;;       div.textContent = div.dataset.value;     }   });      // 마우스 이벤트 제거   document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);   document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler); }      완성         직접 해보기     이지선다 지옥…    크아아아아아아아악     반성              DOM 직접 컨트롤 피하기 이유는 상술           디자인 및 접근성 뭔가 더 예쁘고 접근성 좋게 처리할 수 있었을 거란 아쉬움이 남는다 div 사이 빈 줄도 없앨 수 있었을텐데… AI도 잘 되어있는 세상인데…         코드 확인      Link to GitHub">







  <meta property="article:published_time" content="2025-04-29T22:00:00+00:00">



  <meta property="article:modified_time" content="2025-04-29T22:00:00+00:00">




<link rel="canonical" href="https://movingwoo.github.io/one-pan/javascript/2025/04/29/Minesweeper.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Archive",
      "url": "https://movingwoo.github.io/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="The Archive Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          The Archive
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
            <a href="/board?path=" class="explorer-link">explorer</a>
          </li>
        </ul>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="제목 검색" class="search-input">
          <button class="search-button" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

<!-- 
  <h1 class="title__logo"><a href="https://movingwoo.github.io/">The Archive</a></h1>
 -->



<script src="/assets/js/search.js"></script>


    <div class="initial-content">
      



<div class="home-layout">
  <div class="home-sidebar">
    







<aside class="sidebar__left">
  <div class="toc-wrapper">
    <nav class="toc">
      <header>
        <h4 class="nav__title">
          <span class="title-text">
            <i class="fas fa-sitemap"></i> Archive
          </span>
          <a href="/board?path=" class="search-link" title="탐색">
            <i class="fas fa-list-ul"></i>
          </a>
        </h4>
      </header>

      <ul class="toc__menu">
        
          
          
          
          
          
          
          <li class="toc__item depth-0" data-path="one-pan/" data-total-posts="0">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">one-pan</span>
              
              
            </div>
            
            
            
            <ul class="toc__menu submenu">
              
                
              
                
                  
                  
                  
                
              
                
                  
                  
                  
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/JavaScript/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">JavaScript</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/javascript/2025/04/29/Minesweeper.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 지뢰찾기
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
            </ul>
          </li>
        
          
          
          
          
          
          
          <li class="toc__item depth-1" data-path="one-pan/ShellScript/" data-total-posts="1">
            <div class="toc__menu-title">
              <span class="folder-toggle">
                <i class="fas fa-folder-open"></i>
              </span>
              <span class="folder-name">ShellScript</span>
              
              
                <span class="post-count">1</span>
              
            </div>
            
            
              <ul class="toc__menu posts-list">
                
                  <li>
                    <a href="/one-pan/shellscript/2025/04/28/Server-Manage-Console.html" class="toc__link">
                      <i class="fas fa-file-alt"></i> 간단한 서버 관리 콘솔
                    </a>
                  </li>
                
                
              </ul>
            
            
            <ul class="toc__menu submenu">
              
                
              
                
              
                
              
            </ul>
          </li>
        
      </ul>
    </nav>
  </div>
</aside>

<link rel="stylesheet" href="/assets/css/main.css">
<script src="/assets/js/toc.js"></script> 
  </div>

  <div class="home-content">
    <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
      <meta itemprop="headline" content="지뢰찾기">
      <meta itemprop="description" content="  탄생 비화  바닐라 JS 재활훈련삼아 투닥투닥 두들겨 봄재활훈련을 마치면 canvas를 이용해 뭐라도 만들어 볼 요량  구현 포인트  1. 지뢰판 뿌리기처음에는 그리드로 대충 만들어 뿌렸는데뿌려놓고 css가 변경될 경우 리드로우가 일어난다고 한다.그래서 DOM을 직접 컨트롤하는건 권장하지 않는다고지뢰찾기 몇 칸 넣는데 영향은 없겠지만 연습삼아 fragment를 사용해본다.그리고 옛날사람처럼 굴지말고 템플릿 리터럴을 활용하면 더 깔끔해진다.// 스타일 설정mainArea.style.width = &#39;800px&#39;;mainArea.style.display = &#39;grid&#39;;// 템플릿 리터럴을 사용하지 않으면 보기 지저분하게 + 해가며 써야함// mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + col + &#39;, 1fr)&#39;;// mainArea.style.gridTemplateColumns = &#39;repeat(&#39; + row + &#39;, 1fr)&#39;;mainArea.style.gridTemplateColumns = `repeat(${col}, 1fr)`;mainArea.style.gridTemplateRows = `repeat(${row}, 1fr)`;mainArea.style.gap = &#39;1px&#39;; 			// fragment 생성const divFragment = document.createDocumentFragment();for (let i = 0; i &lt; col * row; i++) {  const newDiv = document.createElement(&#39;div&#39;);  const currentRow = Math.floor(i / col) + 1;  const currentCol = (i % col) + 1;    // 각 div에는 col과 row로 이루어진 고유 값을 id로 설정한다.  // col과 row로 고유 id 설정  newDiv.id = `${currentRow} ${currentCol}`;    // 스타일 설정  newDiv.style.aspectRatio = &#39;1 / 1&#39;;  newDiv.style.border = &#39;1px solid black&#39;;  newDiv.style.padding = &#39;1px&#39;;  newDiv.style.display = &#39;flex&#39;;  newDiv.style.alignItems = &#39;center&#39;;  newDiv.style.justifyContent = &#39;center&#39;;  newDiv.style.background = &#39;gray&#39;  // fragment에 추가  divFragment.appendChild(newDiv);}// DOM에 추가mainArea.appendChild(divFragment);2. 클릭 감지좌클릭 우클릭은 간단하지만 지뢰찾기는 동시클릭 시 주변에 지뢰가 있을 가능성이 있는 타일을 표시해준다.따라서 동시클릭을 인식하도록 해야한다.마우스 좌우를 한 치 오차없이 누르는 건 불가능하기 때문에, 유예시간을 짧게 두고 양쪽이 모두 클릭되어있으면 동시 클릭으로 취급해야한다./**마우스 다운 이벤트*/function MouseDownHandler(event) {  if (!startTime) startTime = new Date(); // 첫 클릭 시간 체크  // 클릭한 타겟의 id와 value 획득  const targetId = event.target.id;  const targetValue = event.target.dataset.value;  if (!targetId || !targetValue) return;  // 0은 좌클릭, 2는 우클릭  if (event.button === 0) leftDown = true;  else if (event.button === 2) rightDown = true;  if (clickDelay) clearTimeout(clickDelay); // 이전 timeout이 있으면 취소  clickDelay = setTimeout(() =&gt; {    // 변수 불값으로 판단    if (leftDown &amp;&amp; rightDown) check(event.target);    else if (leftDown) open(event.target);    else if (rightDown) flag(event.target);        // 초기화    clickDelay = null;  }, 50); // 딜레이 50ms}3. 지뢰 설정고유의 id를 가지고 있는 판을 만들었으니 지뢰를 배치해야 한다.지뢰 주변에는 숫자가 표기되어야 하는데, 구조 상 숫자는 0에서 8까지만 쓸 수 있다.따라서 지뢰를 9로 배치하고 나머지 칸엔 주변 지뢰상황을 파악해 숫자를 매긴다.// set을 이용해 무작위 칸에 value 9를 세팅한다.const divs = document.querySelectorAll(&#39;#main_area div&#39;);const mineSet = new Set(); // 중복 방지용 setwhile (mineSet.size &lt; mines) {  // 무작위 인덱스 값 생성  const randomIdx = Math.floor(Math.random() * col * row);    if (!mineSet.has(randomIdx)) {    // set에 집어넣으며 지뢰 세팅    mineSet.add(randomIdx);    divs[randomIdx].dataset.value = 9;  }}// 전체 div를 탐색하며 9가 아닌 경우 주변 칸이 9인 개수를 세팅한다.divs.forEach(div =&gt; {  if (div.dataset.value == 9) return;  // 유효한 인접 div 가져오기  const validNeighbors = findNeighbors(div.id);  // 유효 범위 내 지뢰 개수 카운팅  let mineCount = 0;  validNeighbors.forEach(([r, c]) =&gt; {      const neighborDiv = document.getElementById(`${r} ${c}`);      if (neighborDiv &amp;&amp; neighborDiv.dataset.value == 9) {          mineCount++;      }  });  div.dataset.value = mineCount;});지뢰 제외 숫자를 세팅하기위해 특정 div의 주변 div를 탐색하는 함수를 별도로 만들어준다.좌클릭으로 칸을 열때, 자동으로 열릴때, 동시클릭 시 등 쓰일 곳이 많은 공통함수이다./**인접 div 탐색*/function findNeighbors(divId) {  // id를 파싱해 현재 좌표 확인  const[currentRow, currentCol] = divId.split(&#39; &#39;).map(Number);  // 인접한 전체 좌표 확인  const neighbors = [      [currentRow - 1, currentCol - 1], [currentRow - 1, currentCol], [currentRow - 1, currentCol + 1],      [currentRow    , currentCol - 1],         /* 현재 칸 */          [currentRow    , currentCol + 1],      [currentRow + 1, currentCol - 1], [currentRow + 1, currentCol], [currentRow + 1, currentCol + 1]  ];  // 행열 범위를 벗어나면 제외하고 return  return neighbors.filter(([r, c]) =&gt; r &gt;= 1 &amp;&amp; r &lt;= row &amp;&amp; c &gt;= 1 &amp;&amp; c &lt;= col);}4. 지뢰찾기 기능 부여좌클릭, 우클릭, 동시클릭 이벤트에 실제 게임 로직을 부여한다.  좌클릭          지뢰(9)인 경우 게임 오버      지뢰가 아닌 경우                  0인 경우 인접칸을 자동으로 열기          0이 아닌 경우 해당 칸만 열기                      우클릭          지뢰표시(flag)      표시된 칸에 다시 우클릭 시 표시 제거        동시클릭          인접 칸 하이라이팅      만약 인접 칸 모든 곳에 지뢰가 없는 것이 확실한 경우 자동으로 열기      // 닫힌칸은 회색, 열린칸은 흰색, 플래그는 검정색, 하이라이팅은 파란색, 게임오버 시 지뢰 위치는 빨간색/**좌클릭 시 open*/function open(targetDiv) {  // 지뢰칸은 즉시 패배처리  if (targetDiv.dataset.value == 9) {    youLose();    return;  }    targetDiv.style.background = &#39;white&#39;;    // 0인 경우엔 주변 div를 자동으로 열어줌  if (targetDiv.dataset.value == 0) {    findNeighbors(targetDiv.id).forEach(([r, c]) =&gt; {      const div = document.getElementById(`${r} ${c}`);            // 재귀 중 꼬이지 않게 열리지 않은 div만 열기      if (div.style.background == &#39;gray&#39;) open(div);    });  } else {    targetDiv.textContent = targetDiv.dataset.value;  }  }/**우클릭 시 flag*/function flag(targetDiv) {  const remainDiv = document.querySelector(&#39;#remain&#39;);  // 닫혀있는 div에 플래그를 추가하며, 플래그가 추가된 칸일 경우 플래그 해제  if (targetDiv.style.background == &#39;gray&#39;) {    targetDiv.style.background =&#39;black&#39;;    remainDiv.dataset.value = remainDiv.dataset.value - 1;  } else if (targetDiv.style.background == &#39;black&#39;) {    targetDiv.style.background =&#39;gray&#39;;    remainDiv.dataset.value = remainDiv.dataset.value - 1 + 2;  }  }/**동시클릭 시 check*/function check(targetDiv) {  const neighbors = findNeighbors(targetDiv.id);    // 플래그 수  let flagCount = 0;    neighbors.forEach(([r, c]) =&gt; {    if (document.getElementById(`${r} ${c}`).style.background == &#39;black&#39;) flagCount++;  });    // 플래그와 지뢰수가 같으면 open, 아니면 주변 칸 반짝  // 플래그 잘못 표시하여 자동오픈으로 지뢰 터지는것도 가능함  neighbors.forEach(([r, c]) =&gt; {    const div = document.getElementById(`${r} ${c}`);    if (div.style.background == &#39;gray&#39;) {      if (flagCount == targetDiv.dataset.value) open(div);      else div.style.background = &#39;blue&#39;    }  });}5. 승리 및 패배 판정승리 판정은 매 좌클릭 후 체크한다.플래그 체크 안하고 클리어할 수 있으므로 판정은 닫혀있는 div 개수가 총 지뢰수와 같으면 승리한 것으로 한다./**승리 반별*/function checkWin() {  // 닫혀있는 div 개수 세기  let closeCount = 0;    document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {    if (div.style.background != &#39;white&#39;) closeCount++;  });    // 총 지뢰 수와 닫혀있는 div 수가 같으면 승리  if (closeCount === mines) {    youWin();    return;  }}/**승리 처리*/function youWin() {  const endTime = new Date(); // 종료시간  const elapsedTime = Math.floor((endTime - startTime) / 1000); // 경과 시간 초 단위    // 승자에 대한 찬사  alert(`You Win!!\n${Math.floor(elapsedTime / 60)}분 ${elapsedTime % 60}초`);    // 마우스 이벤트 제거  document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);  document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler);}/**패배 처리*/function youLose() {  // 패배자에 대한 조롱  alert(&#39;You Lose!!&#39;);    // 모든 보드 열기  document.querySelectorAll(&#39;#main_area div&#39;).forEach(div =&gt; {    if (div.dataset.value == 9) {      // 지뢰 위치는 빨간색으로 표시      div.style.background = &#39;red&#39;;    } else {      div.style.background = &#39;white&#39;;      div.textContent = div.dataset.value;    }  });    // 마우스 이벤트 제거  document.removeEventListener(&#39;mousedown&#39;, MouseDownHandler);  document.removeEventListener(&#39;mouseup&#39;, MouseUpHandler);}  완성    직접 해보기이지선다 지옥…크아아아아아아아악  반성        DOM 직접 컨트롤 피하기이유는 상술        디자인 및 접근성뭔가 더 예쁘고 접근성 좋게 처리할 수 있었을 거란 아쉬움이 남는다div 사이 빈 줄도 없앨 수 있었을텐데…AI도 잘 되어있는 세상인데…    코드 확인  Link to GitHub">
      <meta itemprop="datePublished" content="2025-04-29T22:00:00+00:00">
      <meta itemprop="dateModified" content="2025-04-29T22:00:00+00:00">

      <div class="page__inner-wrap">
        
          <header>
            
<div class="post-category">
  <div class="category-path">
    <a href="/board?path=" class="category-link">Archive</a>
    
    
    
      <span class="separator">/</span>
      
      <a href="/board?path=one-pan" class="category-link">
        one-pan
      </a>
      
    
      <span class="separator">/</span>
      
      <a href="/board?path=one-pan/JavaScript" class="category-link">
        JavaScript
      </a>
      
    
  </div>
  <a href="/board?path=one-pan/JavaScript/" class="category-icon" title="리스트">
    <i class="fas fa-list-ul" aria-hidden="true"></i>
  </a>
</div>
 
            <h1 id="page-title" class="page__title" itemprop="headline">지뢰찾기
</h1>
            


          </header>
        

        <section class="page__content" itemprop="text">
          <blockquote>
  <h4 id="탄생-비화">탄생 비화</h4>
  <hr />
</blockquote>

<p><span style="color: orange;"><strong>바닐라 JS 재활훈련삼아 투닥투닥 두들겨 봄</strong></span><br />
재활훈련을 마치면 canvas를 이용해 뭐라도 만들어 볼 요량</p>

<blockquote>
  <h4 id="구현-포인트">구현 포인트</h4>
  <hr />
</blockquote>

<h5 id="1-지뢰판-뿌리기">1. 지뢰판 뿌리기</h5>

<p>처음에는 그리드로 대충 만들어 뿌렸는데<br />
뿌려놓고 css가 변경될 경우 리드로우가 일어난다고 한다.<br />
그래서 DOM을 직접 컨트롤하는건 권장하지 않는다고<br />
지뢰찾기 몇 칸 넣는데 영향은 없겠지만 연습삼아 fragment를 사용해본다.</p>

<p>그리고 옛날사람처럼 굴지말고 템플릿 리터럴을 활용하면 더 깔끔해진다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 스타일 설정</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">800px</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">grid</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// 템플릿 리터럴을 사용하지 않으면 보기 지저분하게 + 해가며 써야함</span>
<span class="c1">// mainArea.style.gridTemplateColumns = 'repeat(' + col + ', 1fr)';</span>
<span class="c1">// mainArea.style.gridTemplateColumns = 'repeat(' + row + ', 1fr)';</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridTemplateColumns</span> <span class="o">=</span> <span class="s2">`repeat(</span><span class="p">${</span><span class="nx">col</span><span class="p">}</span><span class="s2">, 1fr)`</span><span class="p">;</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gridTemplateRows</span> <span class="o">=</span> <span class="s2">`repeat(</span><span class="p">${</span><span class="nx">row</span><span class="p">}</span><span class="s2">, 1fr)`</span><span class="p">;</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">gap</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">1px</span><span class="dl">'</span><span class="p">;</span> 
			
<span class="c1">// fragment 생성</span>
<span class="kd">const</span> <span class="nx">divFragment</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">createDocumentFragment</span><span class="p">();</span>

<span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">col</span> <span class="o">*</span> <span class="nx">row</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">newDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">currentRow</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nx">i</span> <span class="o">/</span> <span class="nx">col</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">currentCol</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="nx">col</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  
  <span class="c1">// 각 div에는 col과 row로 이루어진 고유 값을 id로 설정한다.</span>
  <span class="c1">// col과 row로 고유 id 설정</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">currentRow</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">currentCol</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  
  <span class="c1">// 스타일 설정</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">aspectRatio</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">1 / 1</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">border</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">1px solid black</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">padding</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">1px</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">flex</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">alignItems</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">center</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">justifyContent</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">center</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">newDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">gray</span><span class="dl">'</span>

  <span class="c1">// fragment에 추가</span>
  <span class="nx">divFragment</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span><span class="nx">newDiv</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// DOM에 추가</span>
<span class="nx">mainArea</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span><span class="nx">divFragment</span><span class="p">);</span>
</code></pre></div></div>

<h5 id="2-클릭-감지">2. 클릭 감지</h5>

<p>좌클릭 우클릭은 간단하지만 지뢰찾기는 동시클릭 시 주변에 지뢰가 있을 가능성이 있는 타일을 표시해준다.<br />
따라서 동시클릭을 인식하도록 해야한다.<br />
마우스 좌우를 한 치 오차없이 누르는 건 불가능하기 때문에, 유예시간을 짧게 두고 양쪽이 모두 클릭되어있으면 동시 클릭으로 취급해야한다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
마우스 다운 이벤트
*/</span>
<span class="kd">function</span> <span class="nf">MouseDownHandler</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">startTime</span><span class="p">)</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span> <span class="c1">// 첫 클릭 시간 체크</span>

  <span class="c1">// 클릭한 타겟의 id와 value 획득</span>
  <span class="kd">const</span> <span class="nx">targetId</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">targetValue</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">targetId</span> <span class="o">||</span> <span class="o">!</span><span class="nx">targetValue</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

  <span class="c1">// 0은 좌클릭, 2는 우클릭</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">leftDown</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="nx">rightDown</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

  <span class="k">if </span><span class="p">(</span><span class="nx">clickDelay</span><span class="p">)</span> <span class="nf">clearTimeout</span><span class="p">(</span><span class="nx">clickDelay</span><span class="p">);</span> <span class="c1">// 이전 timeout이 있으면 취소</span>

  <span class="nx">clickDelay</span> <span class="o">=</span> <span class="nf">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// 변수 불값으로 판단</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">leftDown</span> <span class="o">&amp;&amp;</span> <span class="nx">rightDown</span><span class="p">)</span> <span class="nf">check</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">leftDown</span><span class="p">)</span> <span class="nf">open</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">rightDown</span><span class="p">)</span> <span class="nf">flag</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
    
    <span class="c1">// 초기화</span>
    <span class="nx">clickDelay</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">},</span> <span class="mi">50</span><span class="p">);</span> <span class="c1">// 딜레이 50ms</span>
<span class="p">}</span>
</code></pre></div></div>

<h5 id="3-지뢰-설정">3. 지뢰 설정</h5>

<p>고유의 id를 가지고 있는 판을 만들었으니 지뢰를 배치해야 한다.<br />
지뢰 주변에는 숫자가 표기되어야 하는데, 구조 상 숫자는 0에서 8까지만 쓸 수 있다.<br />
따라서 지뢰를 9로 배치하고 나머지 칸엔 주변 지뢰상황을 파악해 숫자를 매긴다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// set을 이용해 무작위 칸에 value 9를 세팅한다.</span>
<span class="kd">const</span> <span class="nx">divs</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">#main_area div</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">mineSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="p">();</span> <span class="c1">// 중복 방지용 set</span>

<span class="k">while </span><span class="p">(</span><span class="nx">mineSet</span><span class="p">.</span><span class="nx">size</span> <span class="o">&lt;</span> <span class="nx">mines</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// 무작위 인덱스 값 생성</span>
  <span class="kd">const</span> <span class="nx">randomIdx</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">col</span> <span class="o">*</span> <span class="nx">row</span><span class="p">);</span>
  
  <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">mineSet</span><span class="p">.</span><span class="nf">has</span><span class="p">(</span><span class="nx">randomIdx</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// set에 집어넣으며 지뢰 세팅</span>
    <span class="nx">mineSet</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nx">randomIdx</span><span class="p">);</span>
    <span class="nx">divs</span><span class="p">[</span><span class="nx">randomIdx</span><span class="p">].</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 전체 div를 탐색하며 9가 아닌 경우 주변 칸이 9인 개수를 세팅한다.</span>
<span class="nx">divs</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="nx">div</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

  <span class="c1">// 유효한 인접 div 가져오기</span>
  <span class="kd">const</span> <span class="nx">validNeighbors</span> <span class="o">=</span> <span class="nf">findNeighbors</span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

  <span class="c1">// 유효 범위 내 지뢰 개수 카운팅</span>
  <span class="kd">let</span> <span class="nx">mineCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">validNeighbors</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(([</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">neighborDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">c</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">neighborDiv</span> <span class="o">&amp;&amp;</span> <span class="nx">neighborDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">mineCount</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">div</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">mineCount</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<p>지뢰 제외 숫자를 세팅하기위해 특정 div의 주변 div를 탐색하는 함수를 별도로 만들어준다.<br />
좌클릭으로 칸을 열때, 자동으로 열릴때, 동시클릭 시 등 쓰일 곳이 많은 공통함수이다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
인접 div 탐색
*/</span>
<span class="kd">function</span> <span class="nf">findNeighbors</span><span class="p">(</span><span class="nx">divId</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// id를 파싱해 현재 좌표 확인</span>
  <span class="kd">const</span><span class="p">[</span><span class="nx">currentRow</span><span class="p">,</span> <span class="nx">currentCol</span><span class="p">]</span> <span class="o">=</span> <span class="nx">divId</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">).</span><span class="nf">map</span><span class="p">(</span><span class="nb">Number</span><span class="p">);</span>

  <span class="c1">// 인접한 전체 좌표 확인</span>
  <span class="kd">const</span> <span class="nx">neighbors</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">[</span><span class="nx">currentRow</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="nx">currentRow</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span><span class="p">],</span> <span class="p">[</span><span class="nx">currentRow</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="nx">currentRow</span>    <span class="p">,</span> <span class="nx">currentCol</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>         <span class="cm">/* 현재 칸 */</span>          <span class="p">[</span><span class="nx">currentRow</span>    <span class="p">,</span> <span class="nx">currentCol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
      <span class="p">[</span><span class="nx">currentRow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="nx">currentRow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span><span class="p">],</span> <span class="p">[</span><span class="nx">currentRow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">currentCol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
  <span class="p">];</span>

  <span class="c1">// 행열 범위를 벗어나면 제외하고 return</span>
  <span class="k">return</span> <span class="nx">neighbors</span><span class="p">.</span><span class="nf">filter</span><span class="p">(([</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="nx">r</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">r</span> <span class="o">&lt;=</span> <span class="nx">row</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">&lt;=</span> <span class="nx">col</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h5 id="4-지뢰찾기-기능-부여">4. 지뢰찾기 기능 부여</h5>

<p>좌클릭, 우클릭, 동시클릭 이벤트에 실제 게임 로직을 부여한다.</p>
<ul>
  <li>좌클릭
    <ul>
      <li>지뢰(9)인 경우 게임 오버</li>
      <li>지뢰가 아닌 경우
        <ul>
          <li>0인 경우 인접칸을 자동으로 열기</li>
          <li>0이 아닌 경우 해당 칸만 열기</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>우클릭
    <ul>
      <li>지뢰표시(flag)</li>
      <li>표시된 칸에 다시 우클릭 시 표시 제거</li>
    </ul>
  </li>
  <li>동시클릭
    <ul>
      <li>인접 칸 하이라이팅</li>
      <li>만약 인접 칸 모든 곳에 지뢰가 없는 것이 확실한 경우 자동으로 열기</li>
    </ul>
  </li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 닫힌칸은 회색, 열린칸은 흰색, 플래그는 검정색, 하이라이팅은 파란색, 게임오버 시 지뢰 위치는 빨간색</span>

<span class="cm">/**
좌클릭 시 open
*/</span>
<span class="kd">function</span> <span class="nf">open</span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// 지뢰칸은 즉시 패배처리</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">youLose</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">;</span>
  
  <span class="c1">// 0인 경우엔 주변 div를 자동으로 열어줌</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">findNeighbors</span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nf">forEach</span><span class="p">(([</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">c</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      
      <span class="c1">// 재귀 중 꼬이지 않게 열리지 않은 div만 열기</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">gray</span><span class="dl">'</span><span class="p">)</span> <span class="nf">open</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>
  
<span class="p">}</span>

<span class="cm">/**
우클릭 시 flag
*/</span>
<span class="kd">function</span> <span class="nf">flag</span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">const</span> <span class="nx">remainDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#remain</span><span class="dl">'</span><span class="p">);</span>

  <span class="c1">// 닫혀있는 div에 플래그를 추가하며, 플래그가 추가된 칸일 경우 플래그 해제</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">gray</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span><span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">remainDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">remainDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span><span class="dl">'</span><span class="s1">gray</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">remainDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">remainDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  
<span class="p">}</span>

<span class="cm">/**
동시클릭 시 check
*/</span>
<span class="kd">function</span> <span class="nf">check</span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">const</span> <span class="nx">neighbors</span> <span class="o">=</span> <span class="nf">findNeighbors</span><span class="p">(</span><span class="nx">targetDiv</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  
  <span class="c1">// 플래그 수</span>
  <span class="kd">let</span> <span class="nx">flagCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  
  <span class="nx">neighbors</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(([</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">c</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span> <span class="nx">flagCount</span><span class="o">++</span><span class="p">;</span>
  <span class="p">});</span>
  
  <span class="c1">// 플래그와 지뢰수가 같으면 open, 아니면 주변 칸 반짝</span>
  <span class="c1">// 플래그 잘못 표시하여 자동오픈으로 지뢰 터지는것도 가능함</span>
  <span class="nx">neighbors</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(([</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">c</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">gray</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">flagCount</span> <span class="o">==</span> <span class="nx">targetDiv</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="nf">open</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
      <span class="k">else</span> <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">blue</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<h5 id="5-승리-및-패배-판정">5. 승리 및 패배 판정</h5>

<p>승리 판정은 매 좌클릭 후 체크한다.<br />
플래그 체크 안하고 클리어할 수 있으므로 판정은 닫혀있는 div 개수가 총 지뢰수와 같으면 승리한 것으로 한다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
승리 반별
*/</span>
<span class="kd">function</span> <span class="nf">checkWin</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// 닫혀있는 div 개수 세기</span>
  <span class="kd">let</span> <span class="nx">closeCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  
  <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">#main_area div</span><span class="dl">'</span><span class="p">).</span><span class="nf">forEach</span><span class="p">(</span><span class="nx">div</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">)</span> <span class="nx">closeCount</span><span class="o">++</span><span class="p">;</span>
  <span class="p">});</span>
  
  <span class="c1">// 총 지뢰 수와 닫혀있는 div 수가 같으면 승리</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">closeCount</span> <span class="o">===</span> <span class="nx">mines</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">youWin</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**
승리 처리
*/</span>
<span class="kd">function</span> <span class="nf">youWin</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">const</span> <span class="nx">endTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="p">();</span> <span class="c1">// 종료시간</span>
  <span class="kd">const</span> <span class="nx">elapsedTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">((</span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span> <span class="c1">// 경과 시간 초 단위</span>
  
  <span class="c1">// 승자에 대한 찬사</span>
  <span class="nf">alert</span><span class="p">(</span><span class="s2">`You Win!!\n</span><span class="p">${</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nx">elapsedTime</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)}</span><span class="s2">분 </span><span class="p">${</span><span class="nx">elapsedTime</span> <span class="o">%</span> <span class="mi">60</span><span class="p">}</span><span class="s2">초`</span><span class="p">);</span>
  
  <span class="c1">// 마우스 이벤트 제거</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">MouseDownHandler</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="nx">MouseUpHandler</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**
패배 처리
*/</span>
<span class="kd">function</span> <span class="nf">youLose</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// 패배자에 대한 조롱</span>
  <span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">You Lose!!</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="c1">// 모든 보드 열기</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">#main_area div</span><span class="dl">'</span><span class="p">).</span><span class="nf">forEach</span><span class="p">(</span><span class="nx">div</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">div</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 지뢰 위치는 빨간색으로 표시</span>
      <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">;</span>
      <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">div</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>
  
  <span class="c1">// 마우스 이벤트 제거</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="nx">MouseDownHandler</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nf">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="nx">MouseUpHandler</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <h4 id="완성">완성</h4>
  <hr />
</blockquote>

<p><a href="/play/Minesweeper.html" target="_blank" rel="noopener noreferrer">
  직접 해보기
</a></p>

<p><img src="/assets/images/posts/one-pan/JavaScript/2025-04-30-Minesweeper/img01.jpg" alt="img01" /></p>

<p>이지선다 지옥…</p>

<p><img src="/assets/images/posts/one-pan/JavaScript/2025-04-30-Minesweeper/img02.jpg" alt="img02" /></p>

<p><span style="color: red;"><strong>크아아아아아아아악</strong></span></p>

<blockquote>
  <h4 id="반성">반성</h4>
  <hr />
</blockquote>

<ol>
  <li>
    <p><strong>DOM 직접 컨트롤 피하기</strong><br />
이유는 상술</p>
  </li>
  <li>
    <p>디자인 및 접근성<br />
뭔가 더 예쁘고 접근성 좋게 처리할 수 있었을 거란 아쉬움이 남는다<br />
div 사이 빈 줄도 없앨 수 있었을텐데…<br />
AI도 잘 되어있는 세상인데…</p>
  </li>
</ol>

<blockquote>
  <h4 id="코드-확인">코드 확인</h4>
  <hr />
</blockquote>

<p><a href="https://raw.githubusercontent.com/movingwoo/movingwoo-snippets/refs/heads/main/one-pan/JavaScript/2025-04-30-Minesweeper.html">Link to GitHub</a></p>


          
        </section>

        <footer class="page__meta">
          
          

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-04-30">April 30, 2025</time></p>


        </footer>

        

        
<nav class="post-navigation">
  <div id="postNavigation" class="post-navigation__container"></div>

  <script>
    // 별도 js로 post data 넘겨주기만
    window.postData = {
      currentPost: {
        title: "지뢰찾기",
        url: "/one-pan/javascript/2025/04/29/Minesweeper.html",
        date: "2025-04-29",
        categories: ["one-pan/JavaScript/"]
      },
      allPosts: [
        
        
          
          
          {
            title: "지뢰찾기",
            url: "/one-pan/javascript/2025/04/29/Minesweeper.html",
            date: "2025-04-29",
            categories: ["one-pan/JavaScript/"]
          },
          
        
          
          
          {
            title: "간단한 서버 관리 콘솔",
            url: "/one-pan/shellscript/2025/04/28/Server-Manage-Console.html",
            date: "2025-04-28",
            categories: ["one-pan/ShellScript/"]
          }
          
        
      ]
    };
  </script>
  <script src="/assets/js/post_pagination.js" defer></script>
</nav>

      </div>

      
    </article>

    
    
  </div>
</div>

<style>
.home-layout {
  display: flex;
  max-width: 1500px;
  margin: 0 auto;
  padding: 0;
}

.home-sidebar {
  flex-shrink: 0;
  width: 300px;
  margin-right: 1rem;
  position: relative;
  display: block !important;
}

.home-content {
  flex-grow: 1;
  min-width: 0;
  width: 100%;
}

@media (max-width: 64em) {
  .home-layout {
    flex-direction: column;
  }
  
  .home-sidebar {
    width: 100%;
    margin-right: 0;
    margin-bottom: 1rem;
  }
  
  .home-content {
    padding: 0;
  }
}
</style>

    </div>

    
    
    <div class="page__footer">
  <div class="page__footer-copyright">
    Visit: <a href="https://github.com/movingwoo/">https://github.com/movingwoo/</a>
    <br>
    <span class="theme-credit">Theme customized from Minimal Mistakes by Michael Rose (MIT License).</span>
  </div>
</div>

    <div class="scroll-button">
  <div class="scroll-button__container">
    <button class="scroll-button__area scroll-button__area--top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="위로">
      <i class="fas fa-arrow-up"></i>
    </button>
    <button class="scroll-button__area scroll-button__area--bottom" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})" title="아래로">
      <i class="fas fa-arrow-down"></i>
    </button>
  </div>
</div>

<style>
.scroll-button {
  position: fixed;
  right: 20px;
  bottom: 20px;
  z-index: 1000;
}

.scroll-button__container {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid rgba(220, 20, 60, 0.6);
  background-color: transparent;
  position: relative;
  overflow: hidden;
}

.scroll-button__area {
  position: absolute;
  width: 100%;
  height: 50%;
  left: 0;
  background: transparent;
  border: none;
  color: rgba(220, 20, 60, 0.6);
  cursor: pointer;
  padding: 0;
  transition: all 0.3s ease;
  outline: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scroll-button__area--top {
  top: 0;
}

.scroll-button__area--bottom {
  bottom: 0;
}

.scroll-button__area:focus {
  outline: none;
}

.scroll-button__area:hover {
  color: rgba(220, 20, 60, 1);
}

.scroll-button__area:hover i {
  transform: scale(1.2);
}

.scroll-button__area i {
  font-size: 1rem;
  transition: transform 0.3s ease;
}

@media (max-width: 768px) {
  .scroll-button {
    right: 10px;
    bottom: 10px;
  }
  
  .scroll-button__container {
    width: 50px;
    height: 50px;
  }
}
</style> 
    
  <script src="/assets/js/main.min.js"></script>









<script>
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});
document.addEventListener('copy', function(e) {
    e.preventDefault();
});
</script>


  </body>
</html>
